{"ast":null,"code":"var _jsxFileName = \"D:\\\\documents\\\\Desktop\\\\safe- chat-AI\\\\frontend\\\\src\\\\pages\\\\Messages.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, useRef } from 'react';\nimport { messagesAPI, usersAPI } from '../services/api';\nimport { useSocket } from '../services/SocketContext';\nimport { useAuth } from '../services/AuthContext';\nimport { ChatBubbleLeftRightIcon, MagnifyingGlassIcon, FunnelIcon, ExclamationTriangleIcon, EyeSlashIcon, TrashIcon, ArrowPathIcon, PaperAirplaneIcon, FaceSmileIcon, ShieldExclamationIcon, UserGroupIcon, UserIcon, PlusIcon } from '@heroicons/react/24/outline';\nimport toast from 'react-hot-toast';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst Messages = () => {\n  _s();\n  const {\n    user\n  } = useAuth();\n  const {\n    socket,\n    connected,\n    realTimeData\n  } = useSocket();\n  const [messages, setMessages] = useState([]);\n  const [users, setUsers] = useState([]);\n  const [onlineUsers, setOnlineUsers] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [usersLoading, setUsersLoading] = useState(false);\n  const [sending, setSending] = useState(false);\n  const [newMessage, setNewMessage] = useState('');\n  const [selectedChatroom, setSelectedChatroom] = useState('general');\n  const [selectedUser, setSelectedUser] = useState(null);\n  const [chatType, setChatType] = useState('public'); // 'public' or 'private'\n  const [showUserList, setShowUserList] = useState(false);\n  const [filters, setFilters] = useState({\n    search: '',\n    emotion: '',\n    flagged: '',\n    abuse_type: '',\n    userId: ''\n  });\n  const [pagination, setPagination] = useState({\n    page: 1,\n    limit: 50,\n    total: 0,\n    pages: 1\n  });\n  const [showFilters, setShowFilters] = useState(false);\n  const messagesEndRef = useRef(null);\n  const chatContainerRef = useRef(null);\n  const chatrooms = [{\n    id: 'general',\n    name: 'General',\n    color: 'bg-blue-100 text-blue-800'\n  }, {\n    id: 'support',\n    name: 'Support',\n    color: 'bg-green-100 text-green-800'\n  }, {\n    id: 'feedback',\n    name: 'Feedback',\n    color: 'bg-purple-100 text-purple-800'\n  }, {\n    id: 'announcements',\n    name: 'Announcements',\n    color: 'bg-yellow-100 text-yellow-800'\n  }];\n  const emotions = [{\n    value: '',\n    label: 'All Emotions'\n  }, {\n    value: 'neutral',\n    label: 'Neutral',\n    color: 'text-gray-600'\n  }, {\n    value: 'joy',\n    label: 'Joy',\n    color: 'text-yellow-600'\n  }, {\n    value: 'anger',\n    label: 'Anger',\n    color: 'text-red-600'\n  }, {\n    value: 'sadness',\n    label: 'Sadness',\n    color: 'text-blue-600'\n  }, {\n    value: 'fear',\n    label: 'Fear',\n    color: 'text-purple-600'\n  }, {\n    value: 'disgust',\n    label: 'Disgust',\n    color: 'text-green-600'\n  }, {\n    value: 'surprise',\n    label: 'Surprise',\n    color: 'text-orange-600'\n  }];\n  const abuseTypes = [{\n    value: '',\n    label: 'All Types'\n  }, {\n    value: 'harassment',\n    label: 'Harassment'\n  }, {\n    value: 'bullying',\n    label: 'Bullying'\n  }, {\n    value: 'hate_speech',\n    label: 'Hate Speech'\n  }, {\n    value: 'threats',\n    label: 'Threats'\n  }, {\n    value: 'spam',\n    label: 'Spam'\n  }, {\n    value: 'sexual_content',\n    label: 'Sexual Content'\n  }];\n  useEffect(() => {\n    fetchMessages();\n    fetchUsers();\n  }, [selectedChatroom, filters, pagination.page]);\n  useEffect(() => {\n    // Listen for real-time messages\n    if (realTimeData.newMessages.length > 0) {\n      const latestMessage = realTimeData.newMessages[0];\n      const currentRoom = chatType === 'private' ? `dm_${getDirectMessageRoomId(selectedUser === null || selectedUser === void 0 ? void 0 : selectedUser._id)}` : selectedChatroom;\n      if (latestMessage.message.chatroom === currentRoom) {\n        setMessages(prev => {\n          const exists = prev.find(msg => msg._id === latestMessage.message._id);\n          if (!exists) {\n            return [latestMessage.message, ...prev];\n          }\n          return prev;\n        });\n        scrollToBottom();\n      }\n    }\n  }, [realTimeData.newMessages, selectedChatroom, selectedUser, chatType]);\n  useEffect(() => {\n    // Listen for online users\n    if (socket && connected) {\n      socket.on('users-online', users => {\n        setOnlineUsers(users);\n      });\n      socket.on('user-joined', user => {\n        setOnlineUsers(prev => [...prev.filter(u => u.id !== user.id), user]);\n      });\n      socket.on('user-left', userId => {\n        setOnlineUsers(prev => prev.filter(u => u.id !== userId));\n      });\n      return () => {\n        socket.off('users-online');\n        socket.off('user-joined');\n        socket.off('user-left');\n      };\n    }\n  }, [socket, connected]);\n  const fetchUsers = async () => {\n    try {\n      setUsersLoading(true);\n      const response = await usersAPI.getUsers({\n        limit: 100,\n        isActive: true\n      });\n      setUsers(response.data.data.users.filter(u => u._id !== user.id));\n    } catch (error) {\n      console.error('Error fetching users:', error);\n    } finally {\n      setUsersLoading(false);\n    }\n  };\n  const getDirectMessageRoomId = otherUserId => {\n    const userIds = [user.id, otherUserId].sort();\n    return userIds.join('_');\n  };\n  const fetchMessages = async () => {\n    try {\n      setLoading(true);\n      const params = {\n        page: pagination.page,\n        limit: pagination.limit,\n        chatroom: chatType === 'private' ? `dm_${getDirectMessageRoomId(selectedUser === null || selectedUser === void 0 ? void 0 : selectedUser._id)}` : selectedChatroom,\n        ...Object.fromEntries(Object.entries(filters).filter(([key, value]) => value !== ''))\n      };\n      const response = await messagesAPI.getMessages(params);\n      setMessages(response.data.data.messages);\n      setPagination(prev => ({\n        ...prev,\n        ...response.data.data.pagination\n      }));\n    } catch (error) {\n      console.error('Error fetching messages:', error);\n      toast.error('Failed to fetch messages');\n    } finally {\n      setLoading(false);\n    }\n  };\n  const sendMessage = async () => {\n    if (!newMessage.trim() || sending) return;\n    if (chatType === 'private' && !selectedUser) {\n      toast.error('Please select a user to send a private message');\n      return;\n    }\n    try {\n      setSending(true);\n      const messageData = {\n        text: newMessage.trim(),\n        chatroom: chatType === 'private' ? `dm_${getDirectMessageRoomId(selectedUser._id)}` : selectedChatroom\n      };\n      if (chatType === 'private') {\n        messageData.recipientId = selectedUser._id;\n        messageData.messageType = 'private';\n      }\n      await messagesAPI.createMessage(messageData);\n      setNewMessage('');\n      toast.success('Message sent!');\n\n      // Refresh messages after a short delay to see the analyzed message\n      setTimeout(() => {\n        fetchMessages();\n      }, 1000);\n    } catch (error) {\n      console.error('Error sending message:', error);\n      toast.error('Failed to send message');\n    } finally {\n      setSending(false);\n    }\n  };\n  const updateMessageStatus = async (messageId, status) => {\n    try {\n      await messagesAPI.updateMessageStatus(messageId, status);\n      toast.success(`Message ${status} successfully`);\n      fetchMessages();\n    } catch (error) {\n      console.error('Error updating message status:', error);\n      toast.error('Failed to update message status');\n    }\n  };\n  const reanalyzeMessage = async messageId => {\n    try {\n      await messagesAPI.reanalyzeMessage(messageId);\n      toast.success('Message re-analyzed successfully');\n      fetchMessages();\n    } catch (error) {\n      console.error('Error re-analyzing message:', error);\n      toast.error('Failed to re-analyze message');\n    }\n  };\n  const scrollToBottom = () => {\n    var _messagesEndRef$curre;\n    (_messagesEndRef$curre = messagesEndRef.current) === null || _messagesEndRef$curre === void 0 ? void 0 : _messagesEndRef$curre.scrollIntoView({\n      behavior: 'smooth'\n    });\n  };\n  const getEmotionColor = emotion => {\n    const emotionObj = emotions.find(e => e.value === emotion);\n    return (emotionObj === null || emotionObj === void 0 ? void 0 : emotionObj.color) || 'text-gray-600';\n  };\n  const getEmotionIcon = emotion => {\n    switch (emotion) {\n      case 'joy':\n        return '😊';\n      case 'anger':\n        return '😠';\n      case 'sadness':\n        return '😢';\n      case 'fear':\n        return '😨';\n      case 'disgust':\n        return '🤢';\n      case 'surprise':\n        return '😲';\n      default:\n        return '😐';\n    }\n  };\n  const getAbuseTypeColor = type => {\n    switch (type) {\n      case 'harassment':\n        return 'bg-red-100 text-red-800';\n      case 'bullying':\n        return 'bg-orange-100 text-orange-800';\n      case 'hate_speech':\n        return 'bg-red-200 text-red-900';\n      case 'threats':\n        return 'bg-red-300 text-red-900';\n      case 'spam':\n        return 'bg-gray-100 text-gray-800';\n      case 'sexual_content':\n        return 'bg-pink-100 text-pink-800';\n      default:\n        return 'bg-gray-100 text-gray-800';\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"space-y-6\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex items-center justify-between\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n          className: \"text-2xl font-bold text-gray-900 flex items-center\",\n          children: [/*#__PURE__*/_jsxDEV(ChatBubbleLeftRightIcon, {\n            className: \"h-8 w-8 mr-3 text-primary-600\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 269,\n            columnNumber: 13\n          }, this), \"Messages\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 268,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"text-gray-600\",\n          children: \"Real-time chat monitoring and analysis\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 272,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 267,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex items-center space-x-3\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: `flex items-center px-3 py-1 rounded-full text-sm ${connected ? 'bg-green-100 text-green-800' : 'bg-red-100 text-red-800'}`,\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: `w-2 h-2 rounded-full mr-2 ${connected ? 'bg-green-500' : 'bg-red-500'}`\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 279,\n            columnNumber: 13\n          }, this), connected ? 'Live' : 'Disconnected']\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 276,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: () => setShowFilters(!showFilters),\n          className: `btn-secondary ${showFilters ? 'bg-primary-100 text-primary-700' : ''}`,\n          children: [/*#__PURE__*/_jsxDEV(FunnelIcon, {\n            className: \"h-4 w-4 mr-2\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 289,\n            columnNumber: 13\n          }, this), \"Filters\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 285,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 275,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 266,\n      columnNumber: 7\n    }, this), showFilters && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"card p-4 space-y-4\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"grid grid-cols-1 md:grid-cols-5 gap-4\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            className: \"block text-sm font-medium text-gray-700 mb-1\",\n            children: \"Search Messages\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 300,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"relative\",\n            children: [/*#__PURE__*/_jsxDEV(MagnifyingGlassIcon, {\n              className: \"h-5 w-5 absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 304,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"text\",\n              value: filters.search,\n              onChange: e => setFilters(prev => ({\n                ...prev,\n                search: e.target.value\n              })),\n              placeholder: \"Search messages...\",\n              className: \"input pl-10\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 305,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 303,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 299,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            className: \"block text-sm font-medium text-gray-700 mb-1\",\n            children: \"Emotion\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 316,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n            value: filters.emotion,\n            onChange: e => setFilters(prev => ({\n              ...prev,\n              emotion: e.target.value\n            })),\n            className: \"input\",\n            children: emotions.map(emotion => /*#__PURE__*/_jsxDEV(\"option\", {\n              value: emotion.value,\n              children: emotion.label\n            }, emotion.value, false, {\n              fileName: _jsxFileName,\n              lineNumber: 325,\n              columnNumber: 19\n            }, this))\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 319,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 315,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            className: \"block text-sm font-medium text-gray-700 mb-1\",\n            children: \"Flagged Status\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 333,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n            value: filters.flagged,\n            onChange: e => setFilters(prev => ({\n              ...prev,\n              flagged: e.target.value\n            })),\n            className: \"input\",\n            children: [/*#__PURE__*/_jsxDEV(\"option\", {\n              value: \"\",\n              children: \"All Messages\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 341,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n              value: \"true\",\n              children: \"Flagged Only\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 342,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n              value: \"false\",\n              children: \"Not Flagged\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 343,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 336,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 332,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            className: \"block text-sm font-medium text-gray-700 mb-1\",\n            children: \"Abuse Type\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 348,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n            value: filters.abuse_type,\n            onChange: e => setFilters(prev => ({\n              ...prev,\n              abuse_type: e.target.value\n            })),\n            className: \"input\",\n            children: abuseTypes.map(type => /*#__PURE__*/_jsxDEV(\"option\", {\n              value: type.value,\n              children: type.label\n            }, type.value, false, {\n              fileName: _jsxFileName,\n              lineNumber: 357,\n              columnNumber: 19\n            }, this))\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 351,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 347,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex items-end\",\n          children: /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => {\n              setFilters({\n                search: '',\n                emotion: '',\n                flagged: '',\n                abuse_type: '',\n                userId: ''\n              });\n              setPagination(prev => ({\n                ...prev,\n                page: 1\n              }));\n            },\n            className: \"btn-secondary w-full\",\n            children: \"Clear Filters\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 365,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 364,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 298,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 297,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"grid grid-cols-1 lg:grid-cols-4 gap-6\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"lg:col-span-1\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"card p-4\",\n          children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n            className: \"font-semibold text-gray-900 mb-4\",\n            children: \"Chatrooms\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 389,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"space-y-2\",\n            children: chatrooms.map(room => /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: () => setSelectedChatroom(room.id),\n              className: `w-full text-left px-3 py-2 rounded-lg transition-colors ${selectedChatroom === room.id ? 'bg-primary-100 text-primary-700 border border-primary-200' : 'hover:bg-gray-100'}`,\n              children: /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"flex items-center justify-between\",\n                children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"font-medium\",\n                  children: room.name\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 402,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: `px-2 py-1 text-xs rounded-full ${room.color}`,\n                  children: [\"#\", room.id]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 403,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 401,\n                columnNumber: 19\n              }, this)\n            }, room.id, false, {\n              fileName: _jsxFileName,\n              lineNumber: 392,\n              columnNumber: 17\n            }, this))\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 390,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 388,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 387,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"lg:col-span-3\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"card p-0 h-[600px] flex flex-col\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"px-6 py-4 border-b border-gray-200 bg-gray-50 rounded-t-lg\",\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"flex items-center justify-between\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n                  className: \"font-semibold text-gray-900\",\n                  children: [\"#\", selectedChatroom]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 420,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                  className: \"text-sm text-gray-600\",\n                  children: [messages.length, \" messages \\u2022 \", connected ? 'Live monitoring' : 'Offline']\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 423,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 419,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                onClick: fetchMessages,\n                disabled: loading,\n                className: \"btn-secondary\",\n                children: /*#__PURE__*/_jsxDEV(ArrowPathIcon, {\n                  className: `h-4 w-4 ${loading ? 'animate-spin' : ''}`\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 432,\n                  columnNumber: 19\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 427,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 418,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 417,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            ref: chatContainerRef,\n            className: \"flex-1 overflow-y-auto p-4 space-y-4\",\n            children: [loading ? /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"flex justify-center items-center h-full\",\n              children: /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 444,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 443,\n              columnNumber: 17\n            }, this) : messages.length === 0 ? /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"flex flex-col items-center justify-center h-full text-gray-500\",\n              children: [/*#__PURE__*/_jsxDEV(ChatBubbleLeftRightIcon, {\n                className: \"h-12 w-12 mb-4\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 448,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                children: \"No messages found\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 449,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                className: \"text-sm\",\n                children: \"Try adjusting your filters or send a message to get started\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 450,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 447,\n              columnNumber: 17\n            }, this) : messages.map(message => {\n              var _message$analysis, _message$analysis2;\n              return /*#__PURE__*/_jsxDEV(\"div\", {\n                className: `flex flex-col space-y-2 p-4 rounded-lg border ${(_message$analysis = message.analysis) !== null && _message$analysis !== void 0 && _message$analysis.abuse_detected ? 'bg-red-50 border-red-200' : message.status === 'flagged' ? 'bg-yellow-50 border-yellow-200' : 'bg-white border-gray-200'}`,\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"flex items-center justify-between\",\n                  children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"flex items-center space-x-3\",\n                    children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                      className: \"font-semibold text-gray-900\",\n                      children: message.username\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 467,\n                      columnNumber: 25\n                    }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                      className: \"text-sm text-gray-500\",\n                      children: new Date(message.createdAt).toLocaleString()\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 470,\n                      columnNumber: 25\n                    }, this), ((_message$analysis2 = message.analysis) === null || _message$analysis2 === void 0 ? void 0 : _message$analysis2.abuse_detected) && /*#__PURE__*/_jsxDEV(ExclamationTriangleIcon, {\n                      className: \"h-4 w-4 text-red-500\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 474,\n                      columnNumber: 27\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 466,\n                    columnNumber: 23\n                  }, this), (user.role === 'moderator' || user.role === 'admin') && /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"flex items-center space-x-2\",\n                    children: [/*#__PURE__*/_jsxDEV(\"button\", {\n                      onClick: () => updateMessageStatus(message._id, 'hidden'),\n                      className: \"text-gray-400 hover:text-gray-600\",\n                      title: \"Hide message\",\n                      children: /*#__PURE__*/_jsxDEV(EyeSlashIcon, {\n                        className: \"h-4 w-4\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 485,\n                        columnNumber: 29\n                      }, this)\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 480,\n                      columnNumber: 27\n                    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                      onClick: () => updateMessageStatus(message._id, 'deleted'),\n                      className: \"text-gray-400 hover:text-red-600\",\n                      title: \"Delete message\",\n                      children: /*#__PURE__*/_jsxDEV(TrashIcon, {\n                        className: \"h-4 w-4\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 492,\n                        columnNumber: 29\n                      }, this)\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 487,\n                      columnNumber: 27\n                    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                      onClick: () => reanalyzeMessage(message._id),\n                      className: \"text-gray-400 hover:text-blue-600\",\n                      title: \"Re-analyze message\",\n                      children: /*#__PURE__*/_jsxDEV(ArrowPathIcon, {\n                        className: \"h-4 w-4\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 499,\n                        columnNumber: 29\n                      }, this)\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 494,\n                      columnNumber: 27\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 479,\n                    columnNumber: 25\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 465,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"text-gray-900\",\n                  children: message.text\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 506,\n                  columnNumber: 21\n                }, this), message.analysis && /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"flex flex-wrap gap-2\",\n                  children: [message.analysis.emotion && /*#__PURE__*/_jsxDEV(\"span\", {\n                    className: `inline-flex items-center px-2 py-1 text-xs rounded-full bg-gray-100 ${getEmotionColor(message.analysis.emotion)}`,\n                    children: [/*#__PURE__*/_jsxDEV(FaceSmileIcon, {\n                      className: \"h-3 w-3 mr-1\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 515,\n                      columnNumber: 29\n                    }, this), getEmotionIcon(message.analysis.emotion), \" \", message.analysis.emotion, message.analysis.emotion_intensity > 0 && /*#__PURE__*/_jsxDEV(\"span\", {\n                      className: \"ml-1\",\n                      children: [\"(\", message.analysis.emotion_intensity, \"%)\"]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 518,\n                      columnNumber: 31\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 514,\n                    columnNumber: 27\n                  }, this), message.analysis.abuse_detected && /*#__PURE__*/_jsxDEV(\"span\", {\n                    className: `inline-flex items-center px-2 py-1 text-xs rounded-full ${getAbuseTypeColor(message.analysis.abuse_type)}`,\n                    children: [/*#__PURE__*/_jsxDEV(ShieldExclamationIcon, {\n                      className: \"h-3 w-3 mr-1\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 525,\n                      columnNumber: 29\n                    }, this), message.analysis.abuse_type, \" (\", message.analysis.confidence_score, \"%)\"]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 524,\n                    columnNumber: 27\n                  }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                    className: `inline-flex items-center px-2 py-1 text-xs rounded-full ${message.status === 'active' ? 'bg-green-100 text-green-800' : message.status === 'flagged' ? 'bg-yellow-100 text-yellow-800' : message.status === 'hidden' ? 'bg-gray-100 text-gray-800' : 'bg-red-100 text-red-800'}`,\n                    children: message.status\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 530,\n                    columnNumber: 25\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 512,\n                  columnNumber: 23\n                }, this)]\n              }, message._id, true, {\n                fileName: _jsxFileName,\n                lineNumber: 454,\n                columnNumber: 19\n              }, this);\n            }), /*#__PURE__*/_jsxDEV(\"div\", {\n              ref: messagesEndRef\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 543,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 438,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"px-4 py-4 border-t border-gray-200 bg-gray-50 rounded-b-lg\",\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"flex space-x-3\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"flex-1\",\n                children: /*#__PURE__*/_jsxDEV(\"input\", {\n                  type: \"text\",\n                  value: newMessage,\n                  onChange: e => setNewMessage(e.target.value),\n                  onKeyPress: e => e.key === 'Enter' && sendMessage(),\n                  placeholder: `Send a message to #${selectedChatroom}...`,\n                  className: \"input\",\n                  disabled: sending\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 550,\n                  columnNumber: 19\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 549,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                onClick: sendMessage,\n                disabled: !newMessage.trim() || sending,\n                className: \"btn-primary\",\n                children: sending ? /*#__PURE__*/_jsxDEV(ArrowPathIcon, {\n                  className: \"h-5 w-5 animate-spin\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 566,\n                  columnNumber: 21\n                }, this) : /*#__PURE__*/_jsxDEV(PaperAirplaneIcon, {\n                  className: \"h-5 w-5\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 568,\n                  columnNumber: 21\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 560,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 548,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 547,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 415,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 414,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 385,\n      columnNumber: 7\n    }, this), pagination.pages > 1 && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex items-center justify-between\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"text-sm text-gray-700\",\n        children: [\"Showing \", Math.min(pagination.limit, pagination.total), \" of \", pagination.total, \" messages\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 580,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex space-x-2\",\n        children: [/*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: () => setPagination(prev => ({\n            ...prev,\n            page: prev.page - 1\n          })),\n          disabled: pagination.page === 1,\n          className: \"btn-secondary disabled:opacity-50\",\n          children: \"Previous\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 584,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"px-3 py-1 text-sm text-gray-700\",\n          children: [\"Page \", pagination.page, \" of \", pagination.pages]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 591,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: () => setPagination(prev => ({\n            ...prev,\n            page: prev.page + 1\n          })),\n          disabled: pagination.page === pagination.pages,\n          className: \"btn-secondary disabled:opacity-50\",\n          children: \"Next\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 594,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 583,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 579,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 264,\n    columnNumber: 5\n  }, this);\n};\n_s(Messages, \"YSnBJ8TgytlpNFD95oS8Kwpfmhg=\", false, function () {\n  return [useAuth, useSocket];\n});\n_c = Messages;\nexport default Messages;\nvar _c;\n$RefreshReg$(_c, \"Messages\");","map":{"version":3,"names":["React","useState","useEffect","useRef","messagesAPI","usersAPI","useSocket","useAuth","ChatBubbleLeftRightIcon","MagnifyingGlassIcon","FunnelIcon","ExclamationTriangleIcon","EyeSlashIcon","TrashIcon","ArrowPathIcon","PaperAirplaneIcon","FaceSmileIcon","ShieldExclamationIcon","UserGroupIcon","UserIcon","PlusIcon","toast","jsxDEV","_jsxDEV","Messages","_s","user","socket","connected","realTimeData","messages","setMessages","users","setUsers","onlineUsers","setOnlineUsers","loading","setLoading","usersLoading","setUsersLoading","sending","setSending","newMessage","setNewMessage","selectedChatroom","setSelectedChatroom","selectedUser","setSelectedUser","chatType","setChatType","showUserList","setShowUserList","filters","setFilters","search","emotion","flagged","abuse_type","userId","pagination","setPagination","page","limit","total","pages","showFilters","setShowFilters","messagesEndRef","chatContainerRef","chatrooms","id","name","color","emotions","value","label","abuseTypes","fetchMessages","fetchUsers","newMessages","length","latestMessage","currentRoom","getDirectMessageRoomId","_id","message","chatroom","prev","exists","find","msg","scrollToBottom","on","filter","u","off","response","getUsers","isActive","data","error","console","otherUserId","userIds","sort","join","params","Object","fromEntries","entries","key","getMessages","sendMessage","trim","messageData","text","recipientId","messageType","createMessage","success","setTimeout","updateMessageStatus","messageId","status","reanalyzeMessage","_messagesEndRef$curre","current","scrollIntoView","behavior","getEmotionColor","emotionObj","e","getEmotionIcon","getAbuseTypeColor","type","className","children","fileName","_jsxFileName","lineNumber","columnNumber","onClick","onChange","target","placeholder","map","room","disabled","ref","_message$analysis","_message$analysis2","analysis","abuse_detected","username","Date","createdAt","toLocaleString","role","title","emotion_intensity","confidence_score","onKeyPress","Math","min","_c","$RefreshReg$"],"sources":["D:/documents/Desktop/safe- chat-AI/frontend/src/pages/Messages.js"],"sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\r\nimport { messagesAPI, usersAPI } from '../services/api';\r\nimport { useSocket } from '../services/SocketContext';\r\nimport { useAuth } from '../services/AuthContext';\r\nimport {\r\n  ChatBubbleLeftRightIcon,\r\n  MagnifyingGlassIcon,\r\n  FunnelIcon,\r\n  ExclamationTriangleIcon,\r\n  EyeSlashIcon,\r\n  TrashIcon,\r\n  ArrowPathIcon,\r\n  PaperAirplaneIcon,\r\n  FaceSmileIcon,\r\n  ShieldExclamationIcon,\r\n  UserGroupIcon,\r\n  UserIcon,\r\n  PlusIcon\r\n} from '@heroicons/react/24/outline';\r\nimport toast from 'react-hot-toast';\r\n\r\nconst Messages = () => {\r\n  const { user } = useAuth();\r\n  const { socket, connected, realTimeData } = useSocket();\r\n  const [messages, setMessages] = useState([]);\r\n  const [users, setUsers] = useState([]);\r\n  const [onlineUsers, setOnlineUsers] = useState([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [usersLoading, setUsersLoading] = useState(false);\r\n  const [sending, setSending] = useState(false);\r\n  const [newMessage, setNewMessage] = useState('');\r\n  const [selectedChatroom, setSelectedChatroom] = useState('general');\r\n  const [selectedUser, setSelectedUser] = useState(null);\r\n  const [chatType, setChatType] = useState('public'); // 'public' or 'private'\r\n  const [showUserList, setShowUserList] = useState(false);\r\n  const [filters, setFilters] = useState({\r\n    search: '',\r\n    emotion: '',\r\n    flagged: '',\r\n    abuse_type: '',\r\n    userId: ''\r\n  });\r\n  const [pagination, setPagination] = useState({\r\n    page: 1,\r\n    limit: 50,\r\n    total: 0,\r\n    pages: 1\r\n  });\r\n  const [showFilters, setShowFilters] = useState(false);\r\n  const messagesEndRef = useRef(null);\r\n  const chatContainerRef = useRef(null);\r\n\r\n  const chatrooms = [\r\n    { id: 'general', name: 'General', color: 'bg-blue-100 text-blue-800' },\r\n    { id: 'support', name: 'Support', color: 'bg-green-100 text-green-800' },\r\n    { id: 'feedback', name: 'Feedback', color: 'bg-purple-100 text-purple-800' },\r\n    { id: 'announcements', name: 'Announcements', color: 'bg-yellow-100 text-yellow-800' }\r\n  ];\r\n\r\n  const emotions = [\r\n    { value: '', label: 'All Emotions' },\r\n    { value: 'neutral', label: 'Neutral', color: 'text-gray-600' },\r\n    { value: 'joy', label: 'Joy', color: 'text-yellow-600' },\r\n    { value: 'anger', label: 'Anger', color: 'text-red-600' },\r\n    { value: 'sadness', label: 'Sadness', color: 'text-blue-600' },\r\n    { value: 'fear', label: 'Fear', color: 'text-purple-600' },\r\n    { value: 'disgust', label: 'Disgust', color: 'text-green-600' },\r\n    { value: 'surprise', label: 'Surprise', color: 'text-orange-600' }\r\n  ];\r\n\r\n  const abuseTypes = [\r\n    { value: '', label: 'All Types' },\r\n    { value: 'harassment', label: 'Harassment' },\r\n    { value: 'bullying', label: 'Bullying' },\r\n    { value: 'hate_speech', label: 'Hate Speech' },\r\n    { value: 'threats', label: 'Threats' },\r\n    { value: 'spam', label: 'Spam' },\r\n    { value: 'sexual_content', label: 'Sexual Content' }\r\n  ];\r\n\r\n  useEffect(() => {\r\n    fetchMessages();\r\n    fetchUsers();\r\n  }, [selectedChatroom, filters, pagination.page]);\r\n\r\n  useEffect(() => {\r\n    // Listen for real-time messages\r\n    if (realTimeData.newMessages.length > 0) {\r\n      const latestMessage = realTimeData.newMessages[0];\r\n      const currentRoom = chatType === 'private' ? `dm_${getDirectMessageRoomId(selectedUser?._id)}` : selectedChatroom;\r\n      \r\n      if (latestMessage.message.chatroom === currentRoom) {\r\n        setMessages(prev => {\r\n          const exists = prev.find(msg => msg._id === latestMessage.message._id);\r\n          if (!exists) {\r\n            return [latestMessage.message, ...prev];\r\n          }\r\n          return prev;\r\n        });\r\n        scrollToBottom();\r\n      }\r\n    }\r\n  }, [realTimeData.newMessages, selectedChatroom, selectedUser, chatType]);\r\n\r\n  useEffect(() => {\r\n    // Listen for online users\r\n    if (socket && connected) {\r\n      socket.on('users-online', (users) => {\r\n        setOnlineUsers(users);\r\n      });\r\n\r\n      socket.on('user-joined', (user) => {\r\n        setOnlineUsers(prev => [...prev.filter(u => u.id !== user.id), user]);\r\n      });\r\n\r\n      socket.on('user-left', (userId) => {\r\n        setOnlineUsers(prev => prev.filter(u => u.id !== userId));\r\n      });\r\n\r\n      return () => {\r\n        socket.off('users-online');\r\n        socket.off('user-joined');\r\n        socket.off('user-left');\r\n      };\r\n    }\r\n  }, [socket, connected]);\r\n\r\n  const fetchUsers = async () => {\r\n    try {\r\n      setUsersLoading(true);\r\n      const response = await usersAPI.getUsers({ limit: 100, isActive: true });\r\n      setUsers(response.data.data.users.filter(u => u._id !== user.id));\r\n    } catch (error) {\r\n      console.error('Error fetching users:', error);\r\n    } finally {\r\n      setUsersLoading(false);\r\n    }\r\n  };\r\n\r\n  const getDirectMessageRoomId = (otherUserId) => {\r\n    const userIds = [user.id, otherUserId].sort();\r\n    return userIds.join('_');\r\n  };\r\n\r\n  const fetchMessages = async () => {\r\n    try {\r\n      setLoading(true);\r\n      const params = {\r\n        page: pagination.page,\r\n        limit: pagination.limit,\r\n        chatroom: chatType === 'private' ? `dm_${getDirectMessageRoomId(selectedUser?._id)}` : selectedChatroom,\r\n        ...Object.fromEntries(\r\n          Object.entries(filters).filter(([key, value]) => value !== '')\r\n        )\r\n      };\r\n\r\n      const response = await messagesAPI.getMessages(params);\r\n      setMessages(response.data.data.messages);\r\n      setPagination(prev => ({\r\n        ...prev,\r\n        ...response.data.data.pagination\r\n      }));\r\n    } catch (error) {\r\n      console.error('Error fetching messages:', error);\r\n      toast.error('Failed to fetch messages');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const sendMessage = async () => {\r\n    if (!newMessage.trim() || sending) return;\r\n\r\n    if (chatType === 'private' && !selectedUser) {\r\n      toast.error('Please select a user to send a private message');\r\n      return;\r\n    }\r\n\r\n    try {\r\n      setSending(true);\r\n      const messageData = {\r\n        text: newMessage.trim(),\r\n        chatroom: chatType === 'private' ? `dm_${getDirectMessageRoomId(selectedUser._id)}` : selectedChatroom\r\n      };\r\n\r\n      if (chatType === 'private') {\r\n        messageData.recipientId = selectedUser._id;\r\n        messageData.messageType = 'private';\r\n      }\r\n\r\n      await messagesAPI.createMessage(messageData);\r\n      \r\n      setNewMessage('');\r\n      toast.success('Message sent!');\r\n      \r\n      // Refresh messages after a short delay to see the analyzed message\r\n      setTimeout(() => {\r\n        fetchMessages();\r\n      }, 1000);\r\n    } catch (error) {\r\n      console.error('Error sending message:', error);\r\n      toast.error('Failed to send message');\r\n    } finally {\r\n      setSending(false);\r\n    }\r\n  };\r\n\r\n  const updateMessageStatus = async (messageId, status) => {\r\n    try {\r\n      await messagesAPI.updateMessageStatus(messageId, status);\r\n      toast.success(`Message ${status} successfully`);\r\n      fetchMessages();\r\n    } catch (error) {\r\n      console.error('Error updating message status:', error);\r\n      toast.error('Failed to update message status');\r\n    }\r\n  };\r\n\r\n  const reanalyzeMessage = async (messageId) => {\r\n    try {\r\n      await messagesAPI.reanalyzeMessage(messageId);\r\n      toast.success('Message re-analyzed successfully');\r\n      fetchMessages();\r\n    } catch (error) {\r\n      console.error('Error re-analyzing message:', error);\r\n      toast.error('Failed to re-analyze message');\r\n    }\r\n  };\r\n\r\n  const scrollToBottom = () => {\r\n    messagesEndRef.current?.scrollIntoView({ behavior: 'smooth' });\r\n  };\r\n\r\n  const getEmotionColor = (emotion) => {\r\n    const emotionObj = emotions.find(e => e.value === emotion);\r\n    return emotionObj?.color || 'text-gray-600';\r\n  };\r\n\r\n  const getEmotionIcon = (emotion) => {\r\n    switch (emotion) {\r\n      case 'joy': return '😊';\r\n      case 'anger': return '😠';\r\n      case 'sadness': return '😢';\r\n      case 'fear': return '😨';\r\n      case 'disgust': return '🤢';\r\n      case 'surprise': return '😲';\r\n      default: return '😐';\r\n    }\r\n  };\r\n\r\n  const getAbuseTypeColor = (type) => {\r\n    switch (type) {\r\n      case 'harassment': return 'bg-red-100 text-red-800';\r\n      case 'bullying': return 'bg-orange-100 text-orange-800';\r\n      case 'hate_speech': return 'bg-red-200 text-red-900';\r\n      case 'threats': return 'bg-red-300 text-red-900';\r\n      case 'spam': return 'bg-gray-100 text-gray-800';\r\n      case 'sexual_content': return 'bg-pink-100 text-pink-800';\r\n      default: return 'bg-gray-100 text-gray-800';\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      {/* Header */}\r\n      <div className=\"flex items-center justify-between\">\r\n        <div>\r\n          <h1 className=\"text-2xl font-bold text-gray-900 flex items-center\">\r\n            <ChatBubbleLeftRightIcon className=\"h-8 w-8 mr-3 text-primary-600\" />\r\n            Messages\r\n          </h1>\r\n          <p className=\"text-gray-600\">Real-time chat monitoring and analysis</p>\r\n        </div>\r\n        \r\n        <div className=\"flex items-center space-x-3\">\r\n          <div className={`flex items-center px-3 py-1 rounded-full text-sm ${\r\n            connected ? 'bg-green-100 text-green-800' : 'bg-red-100 text-red-800'\r\n          }`}>\r\n            <div className={`w-2 h-2 rounded-full mr-2 ${\r\n              connected ? 'bg-green-500' : 'bg-red-500'\r\n            }`}></div>\r\n            {connected ? 'Live' : 'Disconnected'}\r\n          </div>\r\n          \r\n          <button\r\n            onClick={() => setShowFilters(!showFilters)}\r\n            className={`btn-secondary ${showFilters ? 'bg-primary-100 text-primary-700' : ''}`}\r\n          >\r\n            <FunnelIcon className=\"h-4 w-4 mr-2\" />\r\n            Filters\r\n          </button>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Filters */}\r\n      {showFilters && (\r\n        <div className=\"card p-4 space-y-4\">\r\n          <div className=\"grid grid-cols-1 md:grid-cols-5 gap-4\">\r\n            <div>\r\n              <label className=\"block text-sm font-medium text-gray-700 mb-1\">\r\n                Search Messages\r\n              </label>\r\n              <div className=\"relative\">\r\n                <MagnifyingGlassIcon className=\"h-5 w-5 absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400\" />\r\n                <input\r\n                  type=\"text\"\r\n                  value={filters.search}\r\n                  onChange={(e) => setFilters(prev => ({ ...prev, search: e.target.value }))}\r\n                  placeholder=\"Search messages...\"\r\n                  className=\"input pl-10\"\r\n                />\r\n              </div>\r\n            </div>\r\n\r\n            <div>\r\n              <label className=\"block text-sm font-medium text-gray-700 mb-1\">\r\n                Emotion\r\n              </label>\r\n              <select\r\n                value={filters.emotion}\r\n                onChange={(e) => setFilters(prev => ({ ...prev, emotion: e.target.value }))}\r\n                className=\"input\"\r\n              >\r\n                {emotions.map(emotion => (\r\n                  <option key={emotion.value} value={emotion.value}>\r\n                    {emotion.label}\r\n                  </option>\r\n                ))}\r\n              </select>\r\n            </div>\r\n\r\n            <div>\r\n              <label className=\"block text-sm font-medium text-gray-700 mb-1\">\r\n                Flagged Status\r\n              </label>\r\n              <select\r\n                value={filters.flagged}\r\n                onChange={(e) => setFilters(prev => ({ ...prev, flagged: e.target.value }))}\r\n                className=\"input\"\r\n              >\r\n                <option value=\"\">All Messages</option>\r\n                <option value=\"true\">Flagged Only</option>\r\n                <option value=\"false\">Not Flagged</option>\r\n              </select>\r\n            </div>\r\n\r\n            <div>\r\n              <label className=\"block text-sm font-medium text-gray-700 mb-1\">\r\n                Abuse Type\r\n              </label>\r\n              <select\r\n                value={filters.abuse_type}\r\n                onChange={(e) => setFilters(prev => ({ ...prev, abuse_type: e.target.value }))}\r\n                className=\"input\"\r\n              >\r\n                {abuseTypes.map(type => (\r\n                  <option key={type.value} value={type.value}>\r\n                    {type.label}\r\n                  </option>\r\n                ))}\r\n              </select>\r\n            </div>\r\n\r\n            <div className=\"flex items-end\">\r\n              <button\r\n                onClick={() => {\r\n                  setFilters({\r\n                    search: '',\r\n                    emotion: '',\r\n                    flagged: '',\r\n                    abuse_type: '',\r\n                    userId: ''\r\n                  });\r\n                  setPagination(prev => ({ ...prev, page: 1 }));\r\n                }}\r\n                className=\"btn-secondary w-full\"\r\n              >\r\n                Clear Filters\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      <div className=\"grid grid-cols-1 lg:grid-cols-4 gap-6\">\r\n        {/* Chatrooms Sidebar */}\r\n        <div className=\"lg:col-span-1\">\r\n          <div className=\"card p-4\">\r\n            <h3 className=\"font-semibold text-gray-900 mb-4\">Chatrooms</h3>\r\n            <div className=\"space-y-2\">\r\n              {chatrooms.map(room => (\r\n                <button\r\n                  key={room.id}\r\n                  onClick={() => setSelectedChatroom(room.id)}\r\n                  className={`w-full text-left px-3 py-2 rounded-lg transition-colors ${\r\n                    selectedChatroom === room.id\r\n                      ? 'bg-primary-100 text-primary-700 border border-primary-200'\r\n                      : 'hover:bg-gray-100'\r\n                  }`}\r\n                >\r\n                  <div className=\"flex items-center justify-between\">\r\n                    <span className=\"font-medium\">{room.name}</span>\r\n                    <span className={`px-2 py-1 text-xs rounded-full ${room.color}`}>\r\n                      #{room.id}\r\n                    </span>\r\n                  </div>\r\n                </button>\r\n              ))}\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Chat Area */}\r\n        <div className=\"lg:col-span-3\">\r\n          <div className=\"card p-0 h-[600px] flex flex-col\">\r\n            {/* Chat Header */}\r\n            <div className=\"px-6 py-4 border-b border-gray-200 bg-gray-50 rounded-t-lg\">\r\n              <div className=\"flex items-center justify-between\">\r\n                <div>\r\n                  <h3 className=\"font-semibold text-gray-900\">\r\n                    #{selectedChatroom}\r\n                  </h3>\r\n                  <p className=\"text-sm text-gray-600\">\r\n                    {messages.length} messages • {connected ? 'Live monitoring' : 'Offline'}\r\n                  </p>\r\n                </div>\r\n                <button\r\n                  onClick={fetchMessages}\r\n                  disabled={loading}\r\n                  className=\"btn-secondary\"\r\n                >\r\n                  <ArrowPathIcon className={`h-4 w-4 ${loading ? 'animate-spin' : ''}`} />\r\n                </button>\r\n              </div>\r\n            </div>\r\n\r\n            {/* Messages List */}\r\n            <div\r\n              ref={chatContainerRef}\r\n              className=\"flex-1 overflow-y-auto p-4 space-y-4\"\r\n            >\r\n              {loading ? (\r\n                <div className=\"flex justify-center items-center h-full\">\r\n                  <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600\"></div>\r\n                </div>\r\n              ) : messages.length === 0 ? (\r\n                <div className=\"flex flex-col items-center justify-center h-full text-gray-500\">\r\n                  <ChatBubbleLeftRightIcon className=\"h-12 w-12 mb-4\" />\r\n                  <p>No messages found</p>\r\n                  <p className=\"text-sm\">Try adjusting your filters or send a message to get started</p>\r\n                </div>\r\n              ) : (\r\n                messages.map((message) => (\r\n                  <div\r\n                    key={message._id}\r\n                    className={`flex flex-col space-y-2 p-4 rounded-lg border ${\r\n                      message.analysis?.abuse_detected\r\n                        ? 'bg-red-50 border-red-200'\r\n                        : message.status === 'flagged'\r\n                        ? 'bg-yellow-50 border-yellow-200'\r\n                        : 'bg-white border-gray-200'\r\n                    }`}\r\n                  >\r\n                    {/* Message Header */}\r\n                    <div className=\"flex items-center justify-between\">\r\n                      <div className=\"flex items-center space-x-3\">\r\n                        <span className=\"font-semibold text-gray-900\">\r\n                          {message.username}\r\n                        </span>\r\n                        <span className=\"text-sm text-gray-500\">\r\n                          {new Date(message.createdAt).toLocaleString()}\r\n                        </span>\r\n                        {message.analysis?.abuse_detected && (\r\n                          <ExclamationTriangleIcon className=\"h-4 w-4 text-red-500\" />\r\n                        )}\r\n                      </div>\r\n                      \r\n                      {(user.role === 'moderator' || user.role === 'admin') && (\r\n                        <div className=\"flex items-center space-x-2\">\r\n                          <button\r\n                            onClick={() => updateMessageStatus(message._id, 'hidden')}\r\n                            className=\"text-gray-400 hover:text-gray-600\"\r\n                            title=\"Hide message\"\r\n                          >\r\n                            <EyeSlashIcon className=\"h-4 w-4\" />\r\n                          </button>\r\n                          <button\r\n                            onClick={() => updateMessageStatus(message._id, 'deleted')}\r\n                            className=\"text-gray-400 hover:text-red-600\"\r\n                            title=\"Delete message\"\r\n                          >\r\n                            <TrashIcon className=\"h-4 w-4\" />\r\n                          </button>\r\n                          <button\r\n                            onClick={() => reanalyzeMessage(message._id)}\r\n                            className=\"text-gray-400 hover:text-blue-600\"\r\n                            title=\"Re-analyze message\"\r\n                          >\r\n                            <ArrowPathIcon className=\"h-4 w-4\" />\r\n                          </button>\r\n                        </div>\r\n                      )}\r\n                    </div>\r\n\r\n                    {/* Message Content */}\r\n                    <div className=\"text-gray-900\">\r\n                      {message.text}\r\n                    </div>\r\n\r\n                    {/* Analysis Tags */}\r\n                    {message.analysis && (\r\n                      <div className=\"flex flex-wrap gap-2\">\r\n                        {message.analysis.emotion && (\r\n                          <span className={`inline-flex items-center px-2 py-1 text-xs rounded-full bg-gray-100 ${getEmotionColor(message.analysis.emotion)}`}>\r\n                            <FaceSmileIcon className=\"h-3 w-3 mr-1\" />\r\n                            {getEmotionIcon(message.analysis.emotion)} {message.analysis.emotion}\r\n                            {message.analysis.emotion_intensity > 0 && (\r\n                              <span className=\"ml-1\">({message.analysis.emotion_intensity}%)</span>\r\n                            )}\r\n                          </span>\r\n                        )}\r\n                        \r\n                        {message.analysis.abuse_detected && (\r\n                          <span className={`inline-flex items-center px-2 py-1 text-xs rounded-full ${getAbuseTypeColor(message.analysis.abuse_type)}`}>\r\n                            <ShieldExclamationIcon className=\"h-3 w-3 mr-1\" />\r\n                            {message.analysis.abuse_type} ({message.analysis.confidence_score}%)\r\n                          </span>\r\n                        )}\r\n                        \r\n                        <span className={`inline-flex items-center px-2 py-1 text-xs rounded-full ${\r\n                          message.status === 'active' ? 'bg-green-100 text-green-800' :\r\n                          message.status === 'flagged' ? 'bg-yellow-100 text-yellow-800' :\r\n                          message.status === 'hidden' ? 'bg-gray-100 text-gray-800' :\r\n                          'bg-red-100 text-red-800'\r\n                        }`}>\r\n                          {message.status}\r\n                        </span>\r\n                      </div>\r\n                    )}\r\n                  </div>\r\n                ))\r\n              )}\r\n              <div ref={messagesEndRef} />\r\n            </div>\r\n\r\n            {/* Message Input */}\r\n            <div className=\"px-4 py-4 border-t border-gray-200 bg-gray-50 rounded-b-lg\">\r\n              <div className=\"flex space-x-3\">\r\n                <div className=\"flex-1\">\r\n                  <input\r\n                    type=\"text\"\r\n                    value={newMessage}\r\n                    onChange={(e) => setNewMessage(e.target.value)}\r\n                    onKeyPress={(e) => e.key === 'Enter' && sendMessage()}\r\n                    placeholder={`Send a message to #${selectedChatroom}...`}\r\n                    className=\"input\"\r\n                    disabled={sending}\r\n                  />\r\n                </div>\r\n                <button\r\n                  onClick={sendMessage}\r\n                  disabled={!newMessage.trim() || sending}\r\n                  className=\"btn-primary\"\r\n                >\r\n                  {sending ? (\r\n                    <ArrowPathIcon className=\"h-5 w-5 animate-spin\" />\r\n                  ) : (\r\n                    <PaperAirplaneIcon className=\"h-5 w-5\" />\r\n                  )}\r\n                </button>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Pagination */}\r\n      {pagination.pages > 1 && (\r\n        <div className=\"flex items-center justify-between\">\r\n          <div className=\"text-sm text-gray-700\">\r\n            Showing {Math.min(pagination.limit, pagination.total)} of {pagination.total} messages\r\n          </div>\r\n          <div className=\"flex space-x-2\">\r\n            <button\r\n              onClick={() => setPagination(prev => ({ ...prev, page: prev.page - 1 }))}\r\n              disabled={pagination.page === 1}\r\n              className=\"btn-secondary disabled:opacity-50\"\r\n            >\r\n              Previous\r\n            </button>\r\n            <span className=\"px-3 py-1 text-sm text-gray-700\">\r\n              Page {pagination.page} of {pagination.pages}\r\n            </span>\r\n            <button\r\n              onClick={() => setPagination(prev => ({ ...prev, page: prev.page + 1 }))}\r\n              disabled={pagination.page === pagination.pages}\r\n              className=\"btn-secondary disabled:opacity-50\"\r\n            >\r\n              Next\r\n            </button>\r\n          </div>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Messages;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}