{"ast":null,"code":"var _jsxFileName = \"D:\\\\documents\\\\Desktop\\\\safe- chat-AI\\\\frontend\\\\src\\\\pages\\\\Messages.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, useRef } from 'react';\nimport { messagesAPI, usersAPI } from '../services/api';\nimport { useSocket } from '../services/SocketContext';\nimport { useAuth } from '../services/AuthContext';\nimport { ChatBubbleLeftRightIcon, MagnifyingGlassIcon, FunnelIcon, ExclamationTriangleIcon, EyeSlashIcon, TrashIcon, ArrowPathIcon, PaperAirplaneIcon, FaceSmileIcon, ShieldExclamationIcon, UserGroupIcon, UserIcon, PlusIcon } from '@heroicons/react/24/outline';\nimport toast from 'react-hot-toast';\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst Messages = () => {\n  _s();\n  const {\n    user\n  } = useAuth();\n  const {\n    socket,\n    connected,\n    realTimeData\n  } = useSocket();\n  const [messages, setMessages] = useState([]);\n  const [users, setUsers] = useState([]);\n  const [onlineUsers, setOnlineUsers] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [usersLoading, setUsersLoading] = useState(false);\n  const [sending, setSending] = useState(false);\n  const [newMessage, setNewMessage] = useState('');\n  const [selectedChatroom, setSelectedChatroom] = useState('general');\n  const [selectedUser, setSelectedUser] = useState(null);\n  const [chatType, setChatType] = useState('public'); // 'public' or 'private'\n  const [showUserList, setShowUserList] = useState(false);\n  const [filters, setFilters] = useState({\n    search: '',\n    emotion: '',\n    flagged: '',\n    abuse_type: '',\n    userId: ''\n  });\n  const [pagination, setPagination] = useState({\n    page: 1,\n    limit: 50,\n    total: 0,\n    pages: 1\n  });\n  const [showFilters, setShowFilters] = useState(false);\n  const messagesEndRef = useRef(null);\n  const chatContainerRef = useRef(null);\n  const chatrooms = [{\n    id: 'general',\n    name: 'General',\n    color: 'bg-blue-100 text-blue-800'\n  }, {\n    id: 'support',\n    name: 'Support',\n    color: 'bg-green-100 text-green-800'\n  }, {\n    id: 'feedback',\n    name: 'Feedback',\n    color: 'bg-purple-100 text-purple-800'\n  }, {\n    id: 'announcements',\n    name: 'Announcements',\n    color: 'bg-yellow-100 text-yellow-800'\n  }];\n  const emotions = [{\n    value: '',\n    label: 'All Emotions'\n  }, {\n    value: 'neutral',\n    label: 'Neutral',\n    color: 'text-gray-600'\n  }, {\n    value: 'joy',\n    label: 'Joy',\n    color: 'text-yellow-600'\n  }, {\n    value: 'anger',\n    label: 'Anger',\n    color: 'text-red-600'\n  }, {\n    value: 'sadness',\n    label: 'Sadness',\n    color: 'text-blue-600'\n  }, {\n    value: 'fear',\n    label: 'Fear',\n    color: 'text-purple-600'\n  }, {\n    value: 'disgust',\n    label: 'Disgust',\n    color: 'text-green-600'\n  }, {\n    value: 'surprise',\n    label: 'Surprise',\n    color: 'text-orange-600'\n  }];\n  const abuseTypes = [{\n    value: '',\n    label: 'All Types'\n  }, {\n    value: 'harassment',\n    label: 'Harassment'\n  }, {\n    value: 'bullying',\n    label: 'Bullying'\n  }, {\n    value: 'hate_speech',\n    label: 'Hate Speech'\n  }, {\n    value: 'threats',\n    label: 'Threats'\n  }, {\n    value: 'spam',\n    label: 'Spam'\n  }, {\n    value: 'sexual_content',\n    label: 'Sexual Content'\n  }];\n  useEffect(() => {\n    fetchMessages();\n    fetchUsers();\n  }, [selectedChatroom, filters, pagination.page]);\n  useEffect(() => {\n    // Listen for real-time messages\n    if (realTimeData.newMessages.length > 0) {\n      const latestMessage = realTimeData.newMessages[0];\n      const currentRoom = chatType === 'private' ? `dm_${getDirectMessageRoomId(selectedUser === null || selectedUser === void 0 ? void 0 : selectedUser._id)}` : selectedChatroom;\n      if (latestMessage.message.chatroom === currentRoom) {\n        setMessages(prev => {\n          const exists = prev.find(msg => msg._id === latestMessage.message._id);\n          if (!exists) {\n            return [latestMessage.message, ...prev];\n          }\n          return prev;\n        });\n        scrollToBottom();\n      }\n    }\n  }, [realTimeData.newMessages, selectedChatroom, selectedUser, chatType]);\n  useEffect(() => {\n    // Listen for online users\n    if (socket && connected) {\n      socket.on('users-online', users => {\n        setOnlineUsers(users);\n      });\n      socket.on('user-joined', user => {\n        setOnlineUsers(prev => [...prev.filter(u => u.id !== user.id), user]);\n      });\n      socket.on('user-left', userId => {\n        setOnlineUsers(prev => prev.filter(u => u.id !== userId));\n      });\n      return () => {\n        socket.off('users-online');\n        socket.off('user-joined');\n        socket.off('user-left');\n      };\n    }\n  }, [socket, connected]);\n  const fetchUsers = async () => {\n    try {\n      setUsersLoading(true);\n      const response = await usersAPI.getUsers({\n        limit: 100,\n        isActive: true\n      });\n      setUsers(response.data.data.users.filter(u => u._id !== user.id));\n    } catch (error) {\n      console.error('Error fetching users:', error);\n    } finally {\n      setUsersLoading(false);\n    }\n  };\n  const getDirectMessageRoomId = otherUserId => {\n    const userIds = [user.id, otherUserId].sort();\n    return userIds.join('_');\n  };\n  const fetchMessages = async () => {\n    try {\n      setLoading(true);\n      const params = {\n        page: pagination.page,\n        limit: pagination.limit,\n        chatroom: chatType === 'private' ? `dm_${getDirectMessageRoomId(selectedUser === null || selectedUser === void 0 ? void 0 : selectedUser._id)}` : selectedChatroom,\n        ...Object.fromEntries(Object.entries(filters).filter(([key, value]) => value !== ''))\n      };\n      const response = await messagesAPI.getMessages(params);\n      setMessages(response.data.data.messages);\n      setPagination(prev => ({\n        ...prev,\n        ...response.data.data.pagination\n      }));\n    } catch (error) {\n      console.error('Error fetching messages:', error);\n      toast.error('Failed to fetch messages');\n    } finally {\n      setLoading(false);\n    }\n  };\n  const sendMessage = async () => {\n    if (!newMessage.trim() || sending) return;\n    if (chatType === 'private' && !selectedUser) {\n      toast.error('Please select a user to send a private message');\n      return;\n    }\n    try {\n      setSending(true);\n      const messageData = {\n        text: newMessage.trim(),\n        chatroom: chatType === 'private' ? `dm_${getDirectMessageRoomId(selectedUser._id)}` : selectedChatroom\n      };\n      if (chatType === 'private') {\n        messageData.recipientId = selectedUser._id;\n        messageData.messageType = 'private';\n      }\n      await messagesAPI.createMessage(messageData);\n      setNewMessage('');\n      toast.success('Message sent!');\n\n      // Refresh messages after a short delay to see the analyzed message\n      setTimeout(() => {\n        fetchMessages();\n      }, 1000);\n    } catch (error) {\n      console.error('Error sending message:', error);\n      toast.error('Failed to send message');\n    } finally {\n      setSending(false);\n    }\n  };\n  const handleUserSelect = selectedUser => {\n    setSelectedUser(selectedUser);\n    setChatType('private');\n    setSelectedChatroom('');\n    setShowUserList(false);\n    setPagination(prev => ({\n      ...prev,\n      page: 1\n    }));\n    fetchMessages();\n  };\n  const handleChatroomSelect = chatroom => {\n    setSelectedChatroom(chatroom);\n    setChatType('public');\n    setSelectedUser(null);\n    setPagination(prev => ({\n      ...prev,\n      page: 1\n    }));\n    fetchMessages();\n  };\n  const isUserOnline = userId => {\n    return onlineUsers.some(u => u.id === userId);\n  };\n  const getCurrentChatTitle = () => {\n    var _chatrooms$find;\n    if (chatType === 'private' && selectedUser) {\n      return `${selectedUser.username} ${isUserOnline(selectedUser._id) ? 'ðŸŸ¢' : 'âš«'}`;\n    }\n    return ((_chatrooms$find = chatrooms.find(room => room.id === selectedChatroom)) === null || _chatrooms$find === void 0 ? void 0 : _chatrooms$find.name) || 'Select a chatroom';\n  };\n  const updateMessageStatus = async (messageId, status) => {\n    try {\n      await messagesAPI.updateMessageStatus(messageId, status);\n      toast.success(`Message ${status} successfully`);\n      fetchMessages();\n    } catch (error) {\n      console.error('Error updating message status:', error);\n      toast.error('Failed to update message status');\n    }\n  };\n  const reanalyzeMessage = async messageId => {\n    try {\n      await messagesAPI.reanalyzeMessage(messageId);\n      toast.success('Message re-analyzed successfully');\n      fetchMessages();\n    } catch (error) {\n      console.error('Error re-analyzing message:', error);\n      toast.error('Failed to re-analyze message');\n    }\n  };\n  const scrollToBottom = () => {\n    var _messagesEndRef$curre;\n    (_messagesEndRef$curre = messagesEndRef.current) === null || _messagesEndRef$curre === void 0 ? void 0 : _messagesEndRef$curre.scrollIntoView({\n      behavior: 'smooth'\n    });\n  };\n  const getEmotionColor = emotion => {\n    const emotionObj = emotions.find(e => e.value === emotion);\n    return (emotionObj === null || emotionObj === void 0 ? void 0 : emotionObj.color) || 'text-gray-600';\n  };\n  const getEmotionIcon = emotion => {\n    switch (emotion) {\n      case 'joy':\n        return 'ðŸ˜Š';\n      case 'anger':\n        return 'ðŸ˜ ';\n      case 'sadness':\n        return 'ðŸ˜¢';\n      case 'fear':\n        return 'ðŸ˜¨';\n      case 'disgust':\n        return 'ðŸ¤¢';\n      case 'surprise':\n        return 'ðŸ˜²';\n      default:\n        return 'ðŸ˜';\n    }\n  };\n  const getAbuseTypeColor = type => {\n    switch (type) {\n      case 'harassment':\n        return 'bg-red-100 text-red-800';\n      case 'bullying':\n        return 'bg-orange-100 text-orange-800';\n      case 'hate_speech':\n        return 'bg-red-200 text-red-900';\n      case 'threats':\n        return 'bg-red-300 text-red-900';\n      case 'spam':\n        return 'bg-gray-100 text-gray-800';\n      case 'sexual_content':\n        return 'bg-pink-100 text-pink-800';\n      default:\n        return 'bg-gray-100 text-gray-800';\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"space-y-6\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex items-center justify-between\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n          className: \"text-2xl font-bold text-gray-900 flex items-center\",\n          children: [/*#__PURE__*/_jsxDEV(ChatBubbleLeftRightIcon, {\n            className: \"h-8 w-8 mr-3 text-primary-600\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 297,\n            columnNumber: 13\n          }, this), \"Messages\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 296,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"text-gray-600\",\n          children: \"Real-time chat monitoring and analysis\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 300,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 295,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex items-center space-x-3\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: `flex items-center px-3 py-1 rounded-full text-sm ${connected ? 'bg-green-100 text-green-800' : 'bg-red-100 text-red-800'}`,\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: `w-2 h-2 rounded-full mr-2 ${connected ? 'bg-green-500' : 'bg-red-500'}`\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 307,\n            columnNumber: 13\n          }, this), connected ? 'Live' : 'Disconnected']\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 304,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: () => setShowFilters(!showFilters),\n          className: `btn-secondary ${showFilters ? 'bg-primary-100 text-primary-700' : ''}`,\n          children: [/*#__PURE__*/_jsxDEV(FunnelIcon, {\n            className: \"h-4 w-4 mr-2\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 317,\n            columnNumber: 13\n          }, this), \"Filters\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 313,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 303,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 294,\n      columnNumber: 7\n    }, this), showFilters && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"card p-4 space-y-4\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"grid grid-cols-1 md:grid-cols-5 gap-4\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            className: \"block text-sm font-medium text-gray-700 mb-1\",\n            children: \"Search Messages\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 328,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"relative\",\n            children: [/*#__PURE__*/_jsxDEV(MagnifyingGlassIcon, {\n              className: \"h-5 w-5 absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 332,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"text\",\n              value: filters.search,\n              onChange: e => setFilters(prev => ({\n                ...prev,\n                search: e.target.value\n              })),\n              placeholder: \"Search messages...\",\n              className: \"input pl-10\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 333,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 331,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 327,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            className: \"block text-sm font-medium text-gray-700 mb-1\",\n            children: \"Emotion\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 344,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n            value: filters.emotion,\n            onChange: e => setFilters(prev => ({\n              ...prev,\n              emotion: e.target.value\n            })),\n            className: \"input\",\n            children: emotions.map(emotion => /*#__PURE__*/_jsxDEV(\"option\", {\n              value: emotion.value,\n              children: emotion.label\n            }, emotion.value, false, {\n              fileName: _jsxFileName,\n              lineNumber: 353,\n              columnNumber: 19\n            }, this))\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 347,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 343,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            className: \"block text-sm font-medium text-gray-700 mb-1\",\n            children: \"Flagged Status\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 361,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n            value: filters.flagged,\n            onChange: e => setFilters(prev => ({\n              ...prev,\n              flagged: e.target.value\n            })),\n            className: \"input\",\n            children: [/*#__PURE__*/_jsxDEV(\"option\", {\n              value: \"\",\n              children: \"All Messages\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 369,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n              value: \"true\",\n              children: \"Flagged Only\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 370,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n              value: \"false\",\n              children: \"Not Flagged\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 371,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 364,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 360,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            className: \"block text-sm font-medium text-gray-700 mb-1\",\n            children: \"Abuse Type\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 376,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n            value: filters.abuse_type,\n            onChange: e => setFilters(prev => ({\n              ...prev,\n              abuse_type: e.target.value\n            })),\n            className: \"input\",\n            children: abuseTypes.map(type => /*#__PURE__*/_jsxDEV(\"option\", {\n              value: type.value,\n              children: type.label\n            }, type.value, false, {\n              fileName: _jsxFileName,\n              lineNumber: 385,\n              columnNumber: 19\n            }, this))\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 379,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 375,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex items-end\",\n          children: /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => {\n              setFilters({\n                search: '',\n                emotion: '',\n                flagged: '',\n                abuse_type: '',\n                userId: ''\n              });\n              setPagination(prev => ({\n                ...prev,\n                page: 1\n              }));\n            },\n            className: \"btn-secondary w-full\",\n            children: \"Clear Filters\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 393,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 392,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 326,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 325,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"grid grid-cols-1 lg:grid-cols-4 gap-6\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"lg:col-span-1\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"card p-4\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex space-x-1 mb-4 bg-gray-100 p-1 rounded-lg\",\n            children: [/*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: () => {\n                setChatType('public');\n                setSelectedUser(null);\n                if (!selectedChatroom) setSelectedChatroom('general');\n              },\n              className: `flex-1 px-3 py-2 rounded-md text-sm font-medium transition-colors ${chatType === 'public' ? 'bg-white text-primary-700 shadow-sm' : 'text-gray-600 hover:text-gray-900'}`,\n              children: [/*#__PURE__*/_jsxDEV(UserGroupIcon, {\n                className: \"h-4 w-4 inline mr-1\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 431,\n                columnNumber: 17\n              }, this), \"Public\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 419,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: () => {\n                setChatType('private');\n                setSelectedChatroom('');\n                setShowUserList(true);\n              },\n              className: `flex-1 px-3 py-2 rounded-md text-sm font-medium transition-colors ${chatType === 'private' ? 'bg-white text-primary-700 shadow-sm' : 'text-gray-600 hover:text-gray-900'}`,\n              children: [/*#__PURE__*/_jsxDEV(UserIcon, {\n                className: \"h-4 w-4 inline mr-1\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 446,\n                columnNumber: 17\n              }, this), \"Private\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 434,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 418,\n            columnNumber: 13\n          }, this), chatType === 'public' && /*#__PURE__*/_jsxDEV(_Fragment, {\n            children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n              className: \"font-semibold text-gray-900 mb-4\",\n              children: \"Public Chatrooms\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 454,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"space-y-2\",\n              children: chatrooms.map(room => /*#__PURE__*/_jsxDEV(\"button\", {\n                onClick: () => handleChatroomSelect(room.id),\n                className: `w-full text-left px-3 py-2 rounded-lg transition-colors ${selectedChatroom === room.id && chatType === 'public' ? 'bg-primary-100 text-primary-700 border border-primary-200' : 'hover:bg-gray-100'}`,\n                children: /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"flex items-center justify-between\",\n                  children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                    className: \"font-medium\",\n                    children: room.name\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 467,\n                    columnNumber: 25\n                  }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                    className: `px-2 py-1 rounded-full text-xs ${room.color}`,\n                    children: room.id\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 468,\n                    columnNumber: 25\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 466,\n                  columnNumber: 23\n                }, this)\n              }, room.id, false, {\n                fileName: _jsxFileName,\n                lineNumber: 457,\n                columnNumber: 21\n              }, this))\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 455,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true), chatType === 'private' && /*#__PURE__*/_jsxDEV(_Fragment, {\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"flex items-center justify-between mb-4\",\n              children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n                className: \"font-semibold text-gray-900\",\n                children: \"Users\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 482,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"text-sm text-gray-500\",\n                children: [onlineUsers.length, \" online\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 483,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 481,\n              columnNumber: 17\n            }, this), usersLoading ? /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"flex justify-center py-4\",\n              children: /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"animate-spin rounded-full h-6 w-6 border-b-2 border-primary-600\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 490,\n                columnNumber: 21\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 489,\n              columnNumber: 19\n            }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"space-y-2 max-h-96 overflow-y-auto\",\n              children: users.map(user => /*#__PURE__*/_jsxDEV(\"button\", {\n                onClick: () => handleUserSelect(user),\n                className: `w-full text-left px-3 py-2 rounded-lg transition-colors ${(selectedUser === null || selectedUser === void 0 ? void 0 : selectedUser._id) === user._id ? 'bg-primary-100 text-primary-700 border border-primary-200' : 'hover:bg-gray-100'}`,\n                children: /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"flex items-center space-x-3\",\n                  children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"relative\",\n                    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                      className: \"w-8 h-8 bg-primary-100 rounded-full flex items-center justify-center\",\n                      children: /*#__PURE__*/_jsxDEV(\"span\", {\n                        className: \"text-sm font-medium text-primary-700\",\n                        children: user.username.charAt(0).toUpperCase()\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 507,\n                        columnNumber: 31\n                      }, this)\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 506,\n                      columnNumber: 29\n                    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                      className: `absolute -bottom-1 -right-1 w-3 h-3 rounded-full border-2 border-white ${isUserOnline(user._id) ? 'bg-green-500' : 'bg-gray-400'}`\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 511,\n                      columnNumber: 29\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 505,\n                    columnNumber: 27\n                  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"flex-1 min-w-0\",\n                    children: [/*#__PURE__*/_jsxDEV(\"p\", {\n                      className: \"font-medium text-gray-900 truncate\",\n                      children: user.username\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 516,\n                      columnNumber: 29\n                    }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                      className: \"text-xs text-gray-500\",\n                      children: isUserOnline(user._id) ? 'Online' : 'Offline'\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 519,\n                      columnNumber: 29\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 515,\n                    columnNumber: 27\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 504,\n                  columnNumber: 25\n                }, this)\n              }, user._id, false, {\n                fileName: _jsxFileName,\n                lineNumber: 495,\n                columnNumber: 23\n              }, this))\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 493,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 416,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 415,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"lg:col-span-3\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"card p-0 h-[600px] flex flex-col\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"px-6 py-4 border-b border-gray-200 bg-gray-50 rounded-t-lg\",\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"flex items-center justify-between\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n                  className: \"font-semibold text-gray-900\",\n                  children: getCurrentChatTitle()\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 540,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                  className: \"text-sm text-gray-600\",\n                  children: [messages.length, \" messages \\u2022 \", connected ? 'Live monitoring' : 'Offline']\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 543,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 539,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                onClick: fetchMessages,\n                disabled: loading,\n                className: \"btn-secondary\",\n                children: /*#__PURE__*/_jsxDEV(ArrowPathIcon, {\n                  className: `h-4 w-4 ${loading ? 'animate-spin' : ''}`\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 552,\n                  columnNumber: 19\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 547,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 538,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 537,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            ref: chatContainerRef,\n            className: \"flex-1 overflow-y-auto p-4 space-y-4\",\n            children: [loading ? /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"flex justify-center items-center h-full\",\n              children: /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 564,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 563,\n              columnNumber: 17\n            }, this) : messages.length === 0 ? /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"flex flex-col items-center justify-center h-full text-gray-500\",\n              children: [/*#__PURE__*/_jsxDEV(ChatBubbleLeftRightIcon, {\n                className: \"h-12 w-12 mb-4\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 568,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                children: \"No messages found\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 569,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                className: \"text-sm\",\n                children: \"Try adjusting your filters or send a message to get started\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 570,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 567,\n              columnNumber: 17\n            }, this) : messages.map(message => {\n              var _message$analysis, _message$analysis2;\n              return /*#__PURE__*/_jsxDEV(\"div\", {\n                className: `flex flex-col space-y-2 p-4 rounded-lg border ${(_message$analysis = message.analysis) !== null && _message$analysis !== void 0 && _message$analysis.abuse_detected ? 'bg-red-50 border-red-200' : message.status === 'flagged' ? 'bg-yellow-50 border-yellow-200' : 'bg-white border-gray-200'}`,\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"flex items-center justify-between\",\n                  children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"flex items-center space-x-3\",\n                    children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                      className: \"font-semibold text-gray-900\",\n                      children: message.username\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 587,\n                      columnNumber: 25\n                    }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                      className: \"text-sm text-gray-500\",\n                      children: new Date(message.createdAt).toLocaleString()\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 590,\n                      columnNumber: 25\n                    }, this), ((_message$analysis2 = message.analysis) === null || _message$analysis2 === void 0 ? void 0 : _message$analysis2.abuse_detected) && /*#__PURE__*/_jsxDEV(ExclamationTriangleIcon, {\n                      className: \"h-4 w-4 text-red-500\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 594,\n                      columnNumber: 27\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 586,\n                    columnNumber: 23\n                  }, this), (user.role === 'moderator' || user.role === 'admin') && /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"flex items-center space-x-2\",\n                    children: [/*#__PURE__*/_jsxDEV(\"button\", {\n                      onClick: () => updateMessageStatus(message._id, 'hidden'),\n                      className: \"text-gray-400 hover:text-gray-600\",\n                      title: \"Hide message\",\n                      children: /*#__PURE__*/_jsxDEV(EyeSlashIcon, {\n                        className: \"h-4 w-4\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 605,\n                        columnNumber: 29\n                      }, this)\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 600,\n                      columnNumber: 27\n                    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                      onClick: () => updateMessageStatus(message._id, 'deleted'),\n                      className: \"text-gray-400 hover:text-red-600\",\n                      title: \"Delete message\",\n                      children: /*#__PURE__*/_jsxDEV(TrashIcon, {\n                        className: \"h-4 w-4\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 612,\n                        columnNumber: 29\n                      }, this)\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 607,\n                      columnNumber: 27\n                    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                      onClick: () => reanalyzeMessage(message._id),\n                      className: \"text-gray-400 hover:text-blue-600\",\n                      title: \"Re-analyze message\",\n                      children: /*#__PURE__*/_jsxDEV(ArrowPathIcon, {\n                        className: \"h-4 w-4\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 619,\n                        columnNumber: 29\n                      }, this)\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 614,\n                      columnNumber: 27\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 599,\n                    columnNumber: 25\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 585,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"text-gray-900\",\n                  children: message.text\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 626,\n                  columnNumber: 21\n                }, this), message.analysis && /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"flex flex-wrap gap-2\",\n                  children: [message.analysis.emotion && /*#__PURE__*/_jsxDEV(\"span\", {\n                    className: `inline-flex items-center px-2 py-1 text-xs rounded-full bg-gray-100 ${getEmotionColor(message.analysis.emotion)}`,\n                    children: [/*#__PURE__*/_jsxDEV(FaceSmileIcon, {\n                      className: \"h-3 w-3 mr-1\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 635,\n                      columnNumber: 29\n                    }, this), getEmotionIcon(message.analysis.emotion), \" \", message.analysis.emotion, message.analysis.emotion_intensity > 0 && /*#__PURE__*/_jsxDEV(\"span\", {\n                      className: \"ml-1\",\n                      children: [\"(\", message.analysis.emotion_intensity, \"%)\"]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 638,\n                      columnNumber: 31\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 634,\n                    columnNumber: 27\n                  }, this), message.analysis.abuse_detected && /*#__PURE__*/_jsxDEV(\"span\", {\n                    className: `inline-flex items-center px-2 py-1 text-xs rounded-full ${getAbuseTypeColor(message.analysis.abuse_type)}`,\n                    children: [/*#__PURE__*/_jsxDEV(ShieldExclamationIcon, {\n                      className: \"h-3 w-3 mr-1\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 645,\n                      columnNumber: 29\n                    }, this), message.analysis.abuse_type, \" (\", message.analysis.confidence_score, \"%)\"]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 644,\n                    columnNumber: 27\n                  }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                    className: `inline-flex items-center px-2 py-1 text-xs rounded-full ${message.status === 'active' ? 'bg-green-100 text-green-800' : message.status === 'flagged' ? 'bg-yellow-100 text-yellow-800' : message.status === 'hidden' ? 'bg-gray-100 text-gray-800' : 'bg-red-100 text-red-800'}`,\n                    children: message.status\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 650,\n                    columnNumber: 25\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 632,\n                  columnNumber: 23\n                }, this)]\n              }, message._id, true, {\n                fileName: _jsxFileName,\n                lineNumber: 574,\n                columnNumber: 19\n              }, this);\n            }), /*#__PURE__*/_jsxDEV(\"div\", {\n              ref: messagesEndRef\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 663,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 558,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"px-4 py-4 border-t border-gray-200 bg-gray-50 rounded-b-lg\",\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"flex space-x-3\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"flex-1\",\n                children: /*#__PURE__*/_jsxDEV(\"input\", {\n                  type: \"text\",\n                  value: newMessage,\n                  onChange: e => setNewMessage(e.target.value),\n                  onKeyPress: e => e.key === 'Enter' && sendMessage(),\n                  placeholder: `Send a message to #${selectedChatroom}...`,\n                  className: \"input\",\n                  disabled: sending\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 670,\n                  columnNumber: 19\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 669,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                onClick: sendMessage,\n                disabled: !newMessage.trim() || sending,\n                className: \"btn-primary\",\n                children: sending ? /*#__PURE__*/_jsxDEV(ArrowPathIcon, {\n                  className: \"h-5 w-5 animate-spin\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 686,\n                  columnNumber: 21\n                }, this) : /*#__PURE__*/_jsxDEV(PaperAirplaneIcon, {\n                  className: \"h-5 w-5\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 688,\n                  columnNumber: 21\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 680,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 668,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 667,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 535,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 534,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 413,\n      columnNumber: 7\n    }, this), pagination.pages > 1 && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex items-center justify-between\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"text-sm text-gray-700\",\n        children: [\"Showing \", Math.min(pagination.limit, pagination.total), \" of \", pagination.total, \" messages\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 700,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex space-x-2\",\n        children: [/*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: () => setPagination(prev => ({\n            ...prev,\n            page: prev.page - 1\n          })),\n          disabled: pagination.page === 1,\n          className: \"btn-secondary disabled:opacity-50\",\n          children: \"Previous\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 704,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"px-3 py-1 text-sm text-gray-700\",\n          children: [\"Page \", pagination.page, \" of \", pagination.pages]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 711,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: () => setPagination(prev => ({\n            ...prev,\n            page: prev.page + 1\n          })),\n          disabled: pagination.page === pagination.pages,\n          className: \"btn-secondary disabled:opacity-50\",\n          children: \"Next\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 714,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 703,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 699,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 292,\n    columnNumber: 5\n  }, this);\n};\n_s(Messages, \"YSnBJ8TgytlpNFD95oS8Kwpfmhg=\", false, function () {\n  return [useAuth, useSocket];\n});\n_c = Messages;\nexport default Messages;\nvar _c;\n$RefreshReg$(_c, \"Messages\");","map":{"version":3,"names":["React","useState","useEffect","useRef","messagesAPI","usersAPI","useSocket","useAuth","ChatBubbleLeftRightIcon","MagnifyingGlassIcon","FunnelIcon","ExclamationTriangleIcon","EyeSlashIcon","TrashIcon","ArrowPathIcon","PaperAirplaneIcon","FaceSmileIcon","ShieldExclamationIcon","UserGroupIcon","UserIcon","PlusIcon","toast","jsxDEV","_jsxDEV","Fragment","_Fragment","Messages","_s","user","socket","connected","realTimeData","messages","setMessages","users","setUsers","onlineUsers","setOnlineUsers","loading","setLoading","usersLoading","setUsersLoading","sending","setSending","newMessage","setNewMessage","selectedChatroom","setSelectedChatroom","selectedUser","setSelectedUser","chatType","setChatType","showUserList","setShowUserList","filters","setFilters","search","emotion","flagged","abuse_type","userId","pagination","setPagination","page","limit","total","pages","showFilters","setShowFilters","messagesEndRef","chatContainerRef","chatrooms","id","name","color","emotions","value","label","abuseTypes","fetchMessages","fetchUsers","newMessages","length","latestMessage","currentRoom","getDirectMessageRoomId","_id","message","chatroom","prev","exists","find","msg","scrollToBottom","on","filter","u","off","response","getUsers","isActive","data","error","console","otherUserId","userIds","sort","join","params","Object","fromEntries","entries","key","getMessages","sendMessage","trim","messageData","text","recipientId","messageType","createMessage","success","setTimeout","handleUserSelect","handleChatroomSelect","isUserOnline","some","getCurrentChatTitle","_chatrooms$find","username","room","updateMessageStatus","messageId","status","reanalyzeMessage","_messagesEndRef$curre","current","scrollIntoView","behavior","getEmotionColor","emotionObj","e","getEmotionIcon","getAbuseTypeColor","type","className","children","fileName","_jsxFileName","lineNumber","columnNumber","onClick","onChange","target","placeholder","map","charAt","toUpperCase","disabled","ref","_message$analysis","_message$analysis2","analysis","abuse_detected","Date","createdAt","toLocaleString","role","title","emotion_intensity","confidence_score","onKeyPress","Math","min","_c","$RefreshReg$"],"sources":["D:/documents/Desktop/safe- chat-AI/frontend/src/pages/Messages.js"],"sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\r\nimport { messagesAPI, usersAPI } from '../services/api';\r\nimport { useSocket } from '../services/SocketContext';\r\nimport { useAuth } from '../services/AuthContext';\r\nimport {\r\n  ChatBubbleLeftRightIcon,\r\n  MagnifyingGlassIcon,\r\n  FunnelIcon,\r\n  ExclamationTriangleIcon,\r\n  EyeSlashIcon,\r\n  TrashIcon,\r\n  ArrowPathIcon,\r\n  PaperAirplaneIcon,\r\n  FaceSmileIcon,\r\n  ShieldExclamationIcon,\r\n  UserGroupIcon,\r\n  UserIcon,\r\n  PlusIcon\r\n} from '@heroicons/react/24/outline';\r\nimport toast from 'react-hot-toast';\r\n\r\nconst Messages = () => {\r\n  const { user } = useAuth();\r\n  const { socket, connected, realTimeData } = useSocket();\r\n  const [messages, setMessages] = useState([]);\r\n  const [users, setUsers] = useState([]);\r\n  const [onlineUsers, setOnlineUsers] = useState([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [usersLoading, setUsersLoading] = useState(false);\r\n  const [sending, setSending] = useState(false);\r\n  const [newMessage, setNewMessage] = useState('');\r\n  const [selectedChatroom, setSelectedChatroom] = useState('general');\r\n  const [selectedUser, setSelectedUser] = useState(null);\r\n  const [chatType, setChatType] = useState('public'); // 'public' or 'private'\r\n  const [showUserList, setShowUserList] = useState(false);\r\n  const [filters, setFilters] = useState({\r\n    search: '',\r\n    emotion: '',\r\n    flagged: '',\r\n    abuse_type: '',\r\n    userId: ''\r\n  });\r\n  const [pagination, setPagination] = useState({\r\n    page: 1,\r\n    limit: 50,\r\n    total: 0,\r\n    pages: 1\r\n  });\r\n  const [showFilters, setShowFilters] = useState(false);\r\n  const messagesEndRef = useRef(null);\r\n  const chatContainerRef = useRef(null);\r\n\r\n  const chatrooms = [\r\n    { id: 'general', name: 'General', color: 'bg-blue-100 text-blue-800' },\r\n    { id: 'support', name: 'Support', color: 'bg-green-100 text-green-800' },\r\n    { id: 'feedback', name: 'Feedback', color: 'bg-purple-100 text-purple-800' },\r\n    { id: 'announcements', name: 'Announcements', color: 'bg-yellow-100 text-yellow-800' }\r\n  ];\r\n\r\n  const emotions = [\r\n    { value: '', label: 'All Emotions' },\r\n    { value: 'neutral', label: 'Neutral', color: 'text-gray-600' },\r\n    { value: 'joy', label: 'Joy', color: 'text-yellow-600' },\r\n    { value: 'anger', label: 'Anger', color: 'text-red-600' },\r\n    { value: 'sadness', label: 'Sadness', color: 'text-blue-600' },\r\n    { value: 'fear', label: 'Fear', color: 'text-purple-600' },\r\n    { value: 'disgust', label: 'Disgust', color: 'text-green-600' },\r\n    { value: 'surprise', label: 'Surprise', color: 'text-orange-600' }\r\n  ];\r\n\r\n  const abuseTypes = [\r\n    { value: '', label: 'All Types' },\r\n    { value: 'harassment', label: 'Harassment' },\r\n    { value: 'bullying', label: 'Bullying' },\r\n    { value: 'hate_speech', label: 'Hate Speech' },\r\n    { value: 'threats', label: 'Threats' },\r\n    { value: 'spam', label: 'Spam' },\r\n    { value: 'sexual_content', label: 'Sexual Content' }\r\n  ];\r\n\r\n  useEffect(() => {\r\n    fetchMessages();\r\n    fetchUsers();\r\n  }, [selectedChatroom, filters, pagination.page]);\r\n\r\n  useEffect(() => {\r\n    // Listen for real-time messages\r\n    if (realTimeData.newMessages.length > 0) {\r\n      const latestMessage = realTimeData.newMessages[0];\r\n      const currentRoom = chatType === 'private' ? `dm_${getDirectMessageRoomId(selectedUser?._id)}` : selectedChatroom;\r\n      \r\n      if (latestMessage.message.chatroom === currentRoom) {\r\n        setMessages(prev => {\r\n          const exists = prev.find(msg => msg._id === latestMessage.message._id);\r\n          if (!exists) {\r\n            return [latestMessage.message, ...prev];\r\n          }\r\n          return prev;\r\n        });\r\n        scrollToBottom();\r\n      }\r\n    }\r\n  }, [realTimeData.newMessages, selectedChatroom, selectedUser, chatType]);\r\n\r\n  useEffect(() => {\r\n    // Listen for online users\r\n    if (socket && connected) {\r\n      socket.on('users-online', (users) => {\r\n        setOnlineUsers(users);\r\n      });\r\n\r\n      socket.on('user-joined', (user) => {\r\n        setOnlineUsers(prev => [...prev.filter(u => u.id !== user.id), user]);\r\n      });\r\n\r\n      socket.on('user-left', (userId) => {\r\n        setOnlineUsers(prev => prev.filter(u => u.id !== userId));\r\n      });\r\n\r\n      return () => {\r\n        socket.off('users-online');\r\n        socket.off('user-joined');\r\n        socket.off('user-left');\r\n      };\r\n    }\r\n  }, [socket, connected]);\r\n\r\n  const fetchUsers = async () => {\r\n    try {\r\n      setUsersLoading(true);\r\n      const response = await usersAPI.getUsers({ limit: 100, isActive: true });\r\n      setUsers(response.data.data.users.filter(u => u._id !== user.id));\r\n    } catch (error) {\r\n      console.error('Error fetching users:', error);\r\n    } finally {\r\n      setUsersLoading(false);\r\n    }\r\n  };\r\n\r\n  const getDirectMessageRoomId = (otherUserId) => {\r\n    const userIds = [user.id, otherUserId].sort();\r\n    return userIds.join('_');\r\n  };\r\n\r\n  const fetchMessages = async () => {\r\n    try {\r\n      setLoading(true);\r\n      const params = {\r\n        page: pagination.page,\r\n        limit: pagination.limit,\r\n        chatroom: chatType === 'private' ? `dm_${getDirectMessageRoomId(selectedUser?._id)}` : selectedChatroom,\r\n        ...Object.fromEntries(\r\n          Object.entries(filters).filter(([key, value]) => value !== '')\r\n        )\r\n      };\r\n\r\n      const response = await messagesAPI.getMessages(params);\r\n      setMessages(response.data.data.messages);\r\n      setPagination(prev => ({\r\n        ...prev,\r\n        ...response.data.data.pagination\r\n      }));\r\n    } catch (error) {\r\n      console.error('Error fetching messages:', error);\r\n      toast.error('Failed to fetch messages');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const sendMessage = async () => {\r\n    if (!newMessage.trim() || sending) return;\r\n\r\n    if (chatType === 'private' && !selectedUser) {\r\n      toast.error('Please select a user to send a private message');\r\n      return;\r\n    }\r\n\r\n    try {\r\n      setSending(true);\r\n      const messageData = {\r\n        text: newMessage.trim(),\r\n        chatroom: chatType === 'private' ? `dm_${getDirectMessageRoomId(selectedUser._id)}` : selectedChatroom\r\n      };\r\n\r\n      if (chatType === 'private') {\r\n        messageData.recipientId = selectedUser._id;\r\n        messageData.messageType = 'private';\r\n      }\r\n\r\n      await messagesAPI.createMessage(messageData);\r\n      \r\n      setNewMessage('');\r\n      toast.success('Message sent!');\r\n      \r\n      // Refresh messages after a short delay to see the analyzed message\r\n      setTimeout(() => {\r\n        fetchMessages();\r\n      }, 1000);\r\n    } catch (error) {\r\n      console.error('Error sending message:', error);\r\n      toast.error('Failed to send message');\r\n    } finally {\r\n      setSending(false);\r\n    }\r\n  };\r\n\r\n  const handleUserSelect = (selectedUser) => {\r\n    setSelectedUser(selectedUser);\r\n    setChatType('private');\r\n    setSelectedChatroom('');\r\n    setShowUserList(false);\r\n    setPagination(prev => ({ ...prev, page: 1 }));\r\n    fetchMessages();\r\n  };\r\n\r\n  const handleChatroomSelect = (chatroom) => {\r\n    setSelectedChatroom(chatroom);\r\n    setChatType('public');\r\n    setSelectedUser(null);\r\n    setPagination(prev => ({ ...prev, page: 1 }));\r\n    fetchMessages();\r\n  };\r\n\r\n  const isUserOnline = (userId) => {\r\n    return onlineUsers.some(u => u.id === userId);\r\n  };\r\n\r\n  const getCurrentChatTitle = () => {\r\n    if (chatType === 'private' && selectedUser) {\r\n      return `${selectedUser.username} ${isUserOnline(selectedUser._id) ? 'ðŸŸ¢' : 'âš«'}`;\r\n    }\r\n    return chatrooms.find(room => room.id === selectedChatroom)?.name || 'Select a chatroom';\r\n  };\r\n\r\n  const updateMessageStatus = async (messageId, status) => {\r\n    try {\r\n      await messagesAPI.updateMessageStatus(messageId, status);\r\n      toast.success(`Message ${status} successfully`);\r\n      fetchMessages();\r\n    } catch (error) {\r\n      console.error('Error updating message status:', error);\r\n      toast.error('Failed to update message status');\r\n    }\r\n  };\r\n\r\n  const reanalyzeMessage = async (messageId) => {\r\n    try {\r\n      await messagesAPI.reanalyzeMessage(messageId);\r\n      toast.success('Message re-analyzed successfully');\r\n      fetchMessages();\r\n    } catch (error) {\r\n      console.error('Error re-analyzing message:', error);\r\n      toast.error('Failed to re-analyze message');\r\n    }\r\n  };\r\n\r\n  const scrollToBottom = () => {\r\n    messagesEndRef.current?.scrollIntoView({ behavior: 'smooth' });\r\n  };\r\n\r\n  const getEmotionColor = (emotion) => {\r\n    const emotionObj = emotions.find(e => e.value === emotion);\r\n    return emotionObj?.color || 'text-gray-600';\r\n  };\r\n\r\n  const getEmotionIcon = (emotion) => {\r\n    switch (emotion) {\r\n      case 'joy': return 'ðŸ˜Š';\r\n      case 'anger': return 'ðŸ˜ ';\r\n      case 'sadness': return 'ðŸ˜¢';\r\n      case 'fear': return 'ðŸ˜¨';\r\n      case 'disgust': return 'ðŸ¤¢';\r\n      case 'surprise': return 'ðŸ˜²';\r\n      default: return 'ðŸ˜';\r\n    }\r\n  };\r\n\r\n  const getAbuseTypeColor = (type) => {\r\n    switch (type) {\r\n      case 'harassment': return 'bg-red-100 text-red-800';\r\n      case 'bullying': return 'bg-orange-100 text-orange-800';\r\n      case 'hate_speech': return 'bg-red-200 text-red-900';\r\n      case 'threats': return 'bg-red-300 text-red-900';\r\n      case 'spam': return 'bg-gray-100 text-gray-800';\r\n      case 'sexual_content': return 'bg-pink-100 text-pink-800';\r\n      default: return 'bg-gray-100 text-gray-800';\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      {/* Header */}\r\n      <div className=\"flex items-center justify-between\">\r\n        <div>\r\n          <h1 className=\"text-2xl font-bold text-gray-900 flex items-center\">\r\n            <ChatBubbleLeftRightIcon className=\"h-8 w-8 mr-3 text-primary-600\" />\r\n            Messages\r\n          </h1>\r\n          <p className=\"text-gray-600\">Real-time chat monitoring and analysis</p>\r\n        </div>\r\n        \r\n        <div className=\"flex items-center space-x-3\">\r\n          <div className={`flex items-center px-3 py-1 rounded-full text-sm ${\r\n            connected ? 'bg-green-100 text-green-800' : 'bg-red-100 text-red-800'\r\n          }`}>\r\n            <div className={`w-2 h-2 rounded-full mr-2 ${\r\n              connected ? 'bg-green-500' : 'bg-red-500'\r\n            }`}></div>\r\n            {connected ? 'Live' : 'Disconnected'}\r\n          </div>\r\n          \r\n          <button\r\n            onClick={() => setShowFilters(!showFilters)}\r\n            className={`btn-secondary ${showFilters ? 'bg-primary-100 text-primary-700' : ''}`}\r\n          >\r\n            <FunnelIcon className=\"h-4 w-4 mr-2\" />\r\n            Filters\r\n          </button>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Filters */}\r\n      {showFilters && (\r\n        <div className=\"card p-4 space-y-4\">\r\n          <div className=\"grid grid-cols-1 md:grid-cols-5 gap-4\">\r\n            <div>\r\n              <label className=\"block text-sm font-medium text-gray-700 mb-1\">\r\n                Search Messages\r\n              </label>\r\n              <div className=\"relative\">\r\n                <MagnifyingGlassIcon className=\"h-5 w-5 absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400\" />\r\n                <input\r\n                  type=\"text\"\r\n                  value={filters.search}\r\n                  onChange={(e) => setFilters(prev => ({ ...prev, search: e.target.value }))}\r\n                  placeholder=\"Search messages...\"\r\n                  className=\"input pl-10\"\r\n                />\r\n              </div>\r\n            </div>\r\n\r\n            <div>\r\n              <label className=\"block text-sm font-medium text-gray-700 mb-1\">\r\n                Emotion\r\n              </label>\r\n              <select\r\n                value={filters.emotion}\r\n                onChange={(e) => setFilters(prev => ({ ...prev, emotion: e.target.value }))}\r\n                className=\"input\"\r\n              >\r\n                {emotions.map(emotion => (\r\n                  <option key={emotion.value} value={emotion.value}>\r\n                    {emotion.label}\r\n                  </option>\r\n                ))}\r\n              </select>\r\n            </div>\r\n\r\n            <div>\r\n              <label className=\"block text-sm font-medium text-gray-700 mb-1\">\r\n                Flagged Status\r\n              </label>\r\n              <select\r\n                value={filters.flagged}\r\n                onChange={(e) => setFilters(prev => ({ ...prev, flagged: e.target.value }))}\r\n                className=\"input\"\r\n              >\r\n                <option value=\"\">All Messages</option>\r\n                <option value=\"true\">Flagged Only</option>\r\n                <option value=\"false\">Not Flagged</option>\r\n              </select>\r\n            </div>\r\n\r\n            <div>\r\n              <label className=\"block text-sm font-medium text-gray-700 mb-1\">\r\n                Abuse Type\r\n              </label>\r\n              <select\r\n                value={filters.abuse_type}\r\n                onChange={(e) => setFilters(prev => ({ ...prev, abuse_type: e.target.value }))}\r\n                className=\"input\"\r\n              >\r\n                {abuseTypes.map(type => (\r\n                  <option key={type.value} value={type.value}>\r\n                    {type.label}\r\n                  </option>\r\n                ))}\r\n              </select>\r\n            </div>\r\n\r\n            <div className=\"flex items-end\">\r\n              <button\r\n                onClick={() => {\r\n                  setFilters({\r\n                    search: '',\r\n                    emotion: '',\r\n                    flagged: '',\r\n                    abuse_type: '',\r\n                    userId: ''\r\n                  });\r\n                  setPagination(prev => ({ ...prev, page: 1 }));\r\n                }}\r\n                className=\"btn-secondary w-full\"\r\n              >\r\n                Clear Filters\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      <div className=\"grid grid-cols-1 lg:grid-cols-4 gap-6\">\r\n        {/* Chatrooms and Users Sidebar */}\r\n        <div className=\"lg:col-span-1\">\r\n          <div className=\"card p-4\">\r\n            {/* Chat Type Tabs */}\r\n            <div className=\"flex space-x-1 mb-4 bg-gray-100 p-1 rounded-lg\">\r\n              <button\r\n                onClick={() => {\r\n                  setChatType('public');\r\n                  setSelectedUser(null);\r\n                  if (!selectedChatroom) setSelectedChatroom('general');\r\n                }}\r\n                className={`flex-1 px-3 py-2 rounded-md text-sm font-medium transition-colors ${\r\n                  chatType === 'public'\r\n                    ? 'bg-white text-primary-700 shadow-sm'\r\n                    : 'text-gray-600 hover:text-gray-900'\r\n                }`}\r\n              >\r\n                <UserGroupIcon className=\"h-4 w-4 inline mr-1\" />\r\n                Public\r\n              </button>\r\n              <button\r\n                onClick={() => {\r\n                  setChatType('private');\r\n                  setSelectedChatroom('');\r\n                  setShowUserList(true);\r\n                }}\r\n                className={`flex-1 px-3 py-2 rounded-md text-sm font-medium transition-colors ${\r\n                  chatType === 'private'\r\n                    ? 'bg-white text-primary-700 shadow-sm'\r\n                    : 'text-gray-600 hover:text-gray-900'\r\n                }`}\r\n              >\r\n                <UserIcon className=\"h-4 w-4 inline mr-1\" />\r\n                Private\r\n              </button>\r\n            </div>\r\n\r\n            {/* Public Chatrooms */}\r\n            {chatType === 'public' && (\r\n              <>\r\n                <h3 className=\"font-semibold text-gray-900 mb-4\">Public Chatrooms</h3>\r\n                <div className=\"space-y-2\">\r\n                  {chatrooms.map(room => (\r\n                    <button\r\n                      key={room.id}\r\n                      onClick={() => handleChatroomSelect(room.id)}\r\n                      className={`w-full text-left px-3 py-2 rounded-lg transition-colors ${\r\n                        selectedChatroom === room.id && chatType === 'public'\r\n                          ? 'bg-primary-100 text-primary-700 border border-primary-200'\r\n                          : 'hover:bg-gray-100'\r\n                      }`}\r\n                    >\r\n                      <div className=\"flex items-center justify-between\">\r\n                        <span className=\"font-medium\">{room.name}</span>\r\n                        <span className={`px-2 py-1 rounded-full text-xs ${room.color}`}>\r\n                          {room.id}\r\n                        </span>\r\n                      </div>\r\n                    </button>\r\n                  ))}\r\n                </div>\r\n              </>\r\n            )}\r\n\r\n            {/* Users List for Private Chat */}\r\n            {chatType === 'private' && (\r\n              <>\r\n                <div className=\"flex items-center justify-between mb-4\">\r\n                  <h3 className=\"font-semibold text-gray-900\">Users</h3>\r\n                  <span className=\"text-sm text-gray-500\">\r\n                    {onlineUsers.length} online\r\n                  </span>\r\n                </div>\r\n                \r\n                {usersLoading ? (\r\n                  <div className=\"flex justify-center py-4\">\r\n                    <div className=\"animate-spin rounded-full h-6 w-6 border-b-2 border-primary-600\"></div>\r\n                  </div>\r\n                ) : (\r\n                  <div className=\"space-y-2 max-h-96 overflow-y-auto\">\r\n                    {users.map(user => (\r\n                      <button\r\n                        key={user._id}\r\n                        onClick={() => handleUserSelect(user)}\r\n                        className={`w-full text-left px-3 py-2 rounded-lg transition-colors ${\r\n                          selectedUser?._id === user._id\r\n                            ? 'bg-primary-100 text-primary-700 border border-primary-200'\r\n                            : 'hover:bg-gray-100'\r\n                        }`}\r\n                      >\r\n                        <div className=\"flex items-center space-x-3\">\r\n                          <div className=\"relative\">\r\n                            <div className=\"w-8 h-8 bg-primary-100 rounded-full flex items-center justify-center\">\r\n                              <span className=\"text-sm font-medium text-primary-700\">\r\n                                {user.username.charAt(0).toUpperCase()}\r\n                              </span>\r\n                            </div>\r\n                            <div className={`absolute -bottom-1 -right-1 w-3 h-3 rounded-full border-2 border-white ${\r\n                              isUserOnline(user._id) ? 'bg-green-500' : 'bg-gray-400'\r\n                            }`}></div>\r\n                          </div>\r\n                          <div className=\"flex-1 min-w-0\">\r\n                            <p className=\"font-medium text-gray-900 truncate\">\r\n                              {user.username}\r\n                            </p>\r\n                            <p className=\"text-xs text-gray-500\">\r\n                              {isUserOnline(user._id) ? 'Online' : 'Offline'}\r\n                            </p>\r\n                          </div>\r\n                        </div>\r\n                      </button>\r\n                    ))}\r\n                  </div>\r\n                )}\r\n              </>\r\n            )}\r\n          </div>\r\n        </div>\r\n\r\n        {/* Chat Area */}\r\n        <div className=\"lg:col-span-3\">\r\n          <div className=\"card p-0 h-[600px] flex flex-col\">\r\n            {/* Chat Header */}\r\n            <div className=\"px-6 py-4 border-b border-gray-200 bg-gray-50 rounded-t-lg\">\r\n              <div className=\"flex items-center justify-between\">\r\n                <div>\r\n                  <h3 className=\"font-semibold text-gray-900\">\r\n                    {getCurrentChatTitle()}\r\n                  </h3>\r\n                  <p className=\"text-sm text-gray-600\">\r\n                    {messages.length} messages â€¢ {connected ? 'Live monitoring' : 'Offline'}\r\n                  </p>\r\n                </div>\r\n                <button\r\n                  onClick={fetchMessages}\r\n                  disabled={loading}\r\n                  className=\"btn-secondary\"\r\n                >\r\n                  <ArrowPathIcon className={`h-4 w-4 ${loading ? 'animate-spin' : ''}`} />\r\n                </button>\r\n              </div>\r\n            </div>\r\n\r\n            {/* Messages List */}\r\n            <div\r\n              ref={chatContainerRef}\r\n              className=\"flex-1 overflow-y-auto p-4 space-y-4\"\r\n            >\r\n              {loading ? (\r\n                <div className=\"flex justify-center items-center h-full\">\r\n                  <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600\"></div>\r\n                </div>\r\n              ) : messages.length === 0 ? (\r\n                <div className=\"flex flex-col items-center justify-center h-full text-gray-500\">\r\n                  <ChatBubbleLeftRightIcon className=\"h-12 w-12 mb-4\" />\r\n                  <p>No messages found</p>\r\n                  <p className=\"text-sm\">Try adjusting your filters or send a message to get started</p>\r\n                </div>\r\n              ) : (\r\n                messages.map((message) => (\r\n                  <div\r\n                    key={message._id}\r\n                    className={`flex flex-col space-y-2 p-4 rounded-lg border ${\r\n                      message.analysis?.abuse_detected\r\n                        ? 'bg-red-50 border-red-200'\r\n                        : message.status === 'flagged'\r\n                        ? 'bg-yellow-50 border-yellow-200'\r\n                        : 'bg-white border-gray-200'\r\n                    }`}\r\n                  >\r\n                    {/* Message Header */}\r\n                    <div className=\"flex items-center justify-between\">\r\n                      <div className=\"flex items-center space-x-3\">\r\n                        <span className=\"font-semibold text-gray-900\">\r\n                          {message.username}\r\n                        </span>\r\n                        <span className=\"text-sm text-gray-500\">\r\n                          {new Date(message.createdAt).toLocaleString()}\r\n                        </span>\r\n                        {message.analysis?.abuse_detected && (\r\n                          <ExclamationTriangleIcon className=\"h-4 w-4 text-red-500\" />\r\n                        )}\r\n                      </div>\r\n                      \r\n                      {(user.role === 'moderator' || user.role === 'admin') && (\r\n                        <div className=\"flex items-center space-x-2\">\r\n                          <button\r\n                            onClick={() => updateMessageStatus(message._id, 'hidden')}\r\n                            className=\"text-gray-400 hover:text-gray-600\"\r\n                            title=\"Hide message\"\r\n                          >\r\n                            <EyeSlashIcon className=\"h-4 w-4\" />\r\n                          </button>\r\n                          <button\r\n                            onClick={() => updateMessageStatus(message._id, 'deleted')}\r\n                            className=\"text-gray-400 hover:text-red-600\"\r\n                            title=\"Delete message\"\r\n                          >\r\n                            <TrashIcon className=\"h-4 w-4\" />\r\n                          </button>\r\n                          <button\r\n                            onClick={() => reanalyzeMessage(message._id)}\r\n                            className=\"text-gray-400 hover:text-blue-600\"\r\n                            title=\"Re-analyze message\"\r\n                          >\r\n                            <ArrowPathIcon className=\"h-4 w-4\" />\r\n                          </button>\r\n                        </div>\r\n                      )}\r\n                    </div>\r\n\r\n                    {/* Message Content */}\r\n                    <div className=\"text-gray-900\">\r\n                      {message.text}\r\n                    </div>\r\n\r\n                    {/* Analysis Tags */}\r\n                    {message.analysis && (\r\n                      <div className=\"flex flex-wrap gap-2\">\r\n                        {message.analysis.emotion && (\r\n                          <span className={`inline-flex items-center px-2 py-1 text-xs rounded-full bg-gray-100 ${getEmotionColor(message.analysis.emotion)}`}>\r\n                            <FaceSmileIcon className=\"h-3 w-3 mr-1\" />\r\n                            {getEmotionIcon(message.analysis.emotion)} {message.analysis.emotion}\r\n                            {message.analysis.emotion_intensity > 0 && (\r\n                              <span className=\"ml-1\">({message.analysis.emotion_intensity}%)</span>\r\n                            )}\r\n                          </span>\r\n                        )}\r\n                        \r\n                        {message.analysis.abuse_detected && (\r\n                          <span className={`inline-flex items-center px-2 py-1 text-xs rounded-full ${getAbuseTypeColor(message.analysis.abuse_type)}`}>\r\n                            <ShieldExclamationIcon className=\"h-3 w-3 mr-1\" />\r\n                            {message.analysis.abuse_type} ({message.analysis.confidence_score}%)\r\n                          </span>\r\n                        )}\r\n                        \r\n                        <span className={`inline-flex items-center px-2 py-1 text-xs rounded-full ${\r\n                          message.status === 'active' ? 'bg-green-100 text-green-800' :\r\n                          message.status === 'flagged' ? 'bg-yellow-100 text-yellow-800' :\r\n                          message.status === 'hidden' ? 'bg-gray-100 text-gray-800' :\r\n                          'bg-red-100 text-red-800'\r\n                        }`}>\r\n                          {message.status}\r\n                        </span>\r\n                      </div>\r\n                    )}\r\n                  </div>\r\n                ))\r\n              )}\r\n              <div ref={messagesEndRef} />\r\n            </div>\r\n\r\n            {/* Message Input */}\r\n            <div className=\"px-4 py-4 border-t border-gray-200 bg-gray-50 rounded-b-lg\">\r\n              <div className=\"flex space-x-3\">\r\n                <div className=\"flex-1\">\r\n                  <input\r\n                    type=\"text\"\r\n                    value={newMessage}\r\n                    onChange={(e) => setNewMessage(e.target.value)}\r\n                    onKeyPress={(e) => e.key === 'Enter' && sendMessage()}\r\n                    placeholder={`Send a message to #${selectedChatroom}...`}\r\n                    className=\"input\"\r\n                    disabled={sending}\r\n                  />\r\n                </div>\r\n                <button\r\n                  onClick={sendMessage}\r\n                  disabled={!newMessage.trim() || sending}\r\n                  className=\"btn-primary\"\r\n                >\r\n                  {sending ? (\r\n                    <ArrowPathIcon className=\"h-5 w-5 animate-spin\" />\r\n                  ) : (\r\n                    <PaperAirplaneIcon className=\"h-5 w-5\" />\r\n                  )}\r\n                </button>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Pagination */}\r\n      {pagination.pages > 1 && (\r\n        <div className=\"flex items-center justify-between\">\r\n          <div className=\"text-sm text-gray-700\">\r\n            Showing {Math.min(pagination.limit, pagination.total)} of {pagination.total} messages\r\n          </div>\r\n          <div className=\"flex space-x-2\">\r\n            <button\r\n              onClick={() => setPagination(prev => ({ ...prev, page: prev.page - 1 }))}\r\n              disabled={pagination.page === 1}\r\n              className=\"btn-secondary disabled:opacity-50\"\r\n            >\r\n              Previous\r\n            </button>\r\n            <span className=\"px-3 py-1 text-sm text-gray-700\">\r\n              Page {pagination.page} of {pagination.pages}\r\n            </span>\r\n            <button\r\n              onClick={() => setPagination(prev => ({ ...prev, page: prev.page + 1 }))}\r\n              disabled={pagination.page === pagination.pages}\r\n              className=\"btn-secondary disabled:opacity-50\"\r\n            >\r\n              Next\r\n            </button>\r\n          </div>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Messages;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}